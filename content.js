console.log('[ExecLounge] content.js loaded on:', window.location.href);
// Accor Executive Lounge Highlighter - content.js v2.3 Global
// Highlights hotel cards with an Executive Lounge with a thick red border.
// Hotel IDs populated from monthly lounge extraction data.
// Run the "Extract All Lounge Hotels" bookmarklet to get updated IDs.

const EXECUTIVE_LOUNGE_HOTEL_IDS = new Set([
  // ===== AFRICA =====
  // Ghana (1 hotels)
  'B4P0', // Mövenpick Ambassador Hotel Accr
  // Ivory Coast (2 hotels)
  'B4X4', // Mövenpick Hotel Abidjan
  'B1I4', // Novotel Abidjan Marcory
  // Kenya (1 hotels)
  'B4Q7', // Mövenpick Nairobi Hotel & Residences
  // Morocco (1 hotels)
  'A7Z0', // Fairmont La Marina Rabat-Salé

  // ===== ASIA =====
  // Azerbaijan (1 hotels)
  'A593', // Fairmont Baku Flame Towers
  // Cambodia (3 hotels)
  '6526', // Sofitel Phnom Penh Phokeethra
  'B2E8', // Novotel Phnom Penh BKK 1
  '3123', // Sofitel Angkor Phokeethra Golf & Spa Resort
  // China (61 hotels)
  '8276', // Pullman Anshan Time Square
  'A5F9', // Fairmont Beijing
  '6684', // Grand Mercure Beijing Central
  '7025', // Pullman Beijing South
  '8968', // Pullman Changshu Leeman
  'A820', // Fairmont Chengdu
  '8900', // Novotel Daqing Haofang
  '7483', // Pullman Dongguan Changan
  '8719', // Sofitel Foshan
  'A5B2', // Swissôtel Foshan
  '9806', // Pullman Fuzhou Tahoe
  'B2W3', // Pullman Guangzhou Baiyun Airport
  '6318', // Sofitel Guangzhou Sunrich
  '8032', // Novotel Guiyang Downtown
  '8275', // Pullman Guiyang
  '8873', // Sofitel Guiyang Hunter
  '5554', // Sofitel Hangzhou Westlake
  '6824', // Sofitel Harbin
  '9871', // Pullman Hefei Sunac
  '8163', // Pullman Huizhou Kaisa Hotel
  '8509', // Pullman Kaifeng Jianye
  '8529', // Sofitel Kunming
  'A5G2', // Fairmont Yangcheng Lake
  '8102', // Sofitel Lianyungang Suning
  '7468', // Pullman Linyi Lushang
  '7870', // Novotel Nanjing Central Suning
  '7548', // Novotel Nanjing East Suning
  '8737', // Pullman Nanjing Lukou Airport
  '6179', // Sofitel Nanjing Galaxy Suning
  '8310', // Novotel Ningbo East
  '9531', // Novotel Rizhao Suning
  'B851', // Fairmont Sanya Haitang Bay
  '7126', // Pullman Oceanview Sanya Bay Resort & Spa
  '8167', // Sofitel Sanya Leeman Resort
  'A5G7', // Fairmont Peace Hotel
  'C4L4', // Grand Mercure Shanghai Century Park
  '3019', // Novotel Shanghai Atlantis
  'A3P3', // Novotel Shanghai Clover
  '9229', // Novotel Shanghai Hongqiao
  '9307', // Pullman Shanghai Qingpu Excellence
  '9933', // Sofitel Shanghai Hongqiao
  'B9G8', // Sofitel Shanghai North Bund
  'A5C9', // Swissôtel Grand Shanghai
  '8624', // Pullman Shishi Mattison
  '9442', // Novotel Suzhou SIP
  '9936', // Pullman Suzhou Zhonghui
  '8475', // Pullman Taiyuan
  '9807', // Pullman Tangshan
  '8557', // Grand Mercure Urumqi Hualing
  '9590', // Pullman Weifang
  '8837', // Pullman Wenzhou
  'A7Z9', // Fairmont Wuhan
  '7545', // Pullman Wuxi New Lake
  '9804', // The Sebel Xi Ning
  '8160', // Pullman Xiamen Powerlong
  '5949', // Sofitel Xian on Renmin Square
  '9567', // Sofitel Xining
  '7934', // Pullman Zhangjiajie
  '8258', // Novotel Zhengzhou Convention Centre
  '2197', // Sofitel Zhengzhou International
  '7598', // Pullman Shanghai Jing'an
  // Hong Kong (2 hotels)
  '6239', // Novotel Hong Kong Citygate
  '3562', // Novotel Century Hong Kong
  // India (16 hotels)
  '8173', // Novotel Ahmedabad
  'A0L1', // Novotel Vijayawada Varun
  '7535', // Novotel Visakhapatnam Varun Beach
  '6453', // Novotel Bengaluru Outer Ring Road
  '9636', // Novotel Chennai Chamiers Road
  '9581', // Novotel Guwahati GS Road
  '6687', // Novotel Hyderabad Airport
  '6182', // Novotel Hyderabad Convention Centre
  'A5G0', // Fairmont Jaipur
  '6937', // Novotel Kolkata - Hotel & Residences
  '6926', // Novotel Mumbai Juhu Beach
  '6451', // Sofitel Mumbai BKC
  '7560', // Novotel New Delhi Aerocity
  '7559', // Pullman New Delhi Aerocity
  'A0L1', // Novotel Vijayawada Varun
  '7535', // Novotel Visakhapatnam Varun Beach
  // Indonesia (21 hotels)
  '9105', // Novotel Bali Ngurah Rai Airport
  '9078', // Sofitel Bali Nusa Dua Beach Resort
  '8814', // Grand Mercure Bandung Setiabudi
  '9109', // Pullman Bandung Grand Central
  '8489', // Novotel Banjarmasin Airport
  'C2H0', // Swissôtel Nusantara
  'A5G1', // Fairmont Jakarta
  'B151', // Mercure Jakarta Gatot Subroto
  '7447', // Novotel Jakarta Gajah Mada
  '5704', // Novotel Jakarta Mangga Dua Square
  '7536', // Pullman Jakarta Central Park
  '8491', // Pullman Jakarta Indonesia Thamrin CBD
  'B590', // Swissôtel Jakarta Pik Avenue
  '9778', // Grand Mercure Lampung
  '8584', // Novotel Makassar Grand Shayla
  '9054', // Grand Mercure Maha Cipta Medan Angkasa
  '9482', // Novotel Pekanbaru
  '5506', // Novotel Semarang
  'C0I4', // Grand Mercure Solo Baru
  '0545', // Novotel Solo
  '7234', // Novotel Tangerang
  // Japan (7 hotels)
  'B2P9', // Novotel Okinawa Naha
  'C166', // Novotel Nara
  'A5C3', // Swissotel Nankai Osaka
  'C082', // Hôtel Sosei Sapporo MGallery
  'B6R8', // Fairmont Tokyo
  'C1F1', // Mercure Tokyo Hibiya
  'B137', // Pullman Tokyo Tamachi
  // Macao (1 hotels)
  '6480', // Sofitel Macau at Ponte 16
  // Malaysia (7 hotels)
  'B4P4', // Mövenpick Hotel and Convention Centre KLIA
  '6324', // Novotel Kuala Lumpur City Centre
  'A0C5', // Pullman Kuala Lumpur City Centre - Hotel & Residences
  'A0C5', // Pullman Kuala Lumpur City Centre Hotel & Residences
  'A123', // Sofitel Kuala Lumpur Damansara
  '6332', // Pullman Kuching
  '9731', // Pullman Miri Waterfront
  // Myanmar (1 hotels)
  '9045', // Novotel Yangon Max
  // Pakistan (1 hotels)
  'B4N7', // Mövenpick Karachi
  // Philippines (1 hotels)
  'A5G3', // Fairmont Makati
  // Singapore (9 hotels)
  'A5G8', // Fairmont Singapore
  '3610', // Grand Mercure Singapore Roxy
  'A0D7', // Mercure Singapore Bugis
  '9561', // Mercure Singapore On Stevens
  '9543', // Novotel Singapore On Stevens
  'B5L7', // Pullman Singapore Hill Street
  'B9H8', // Pullman Singapore Orchard
  'A152', // Sofitel Singapore City Centre
  'A5D3', // Swissotel The Stamford
  // South Korea (10 hotels)
  'B200', // Fairmont Ambassador Seoul
  '9470', // Grand Mercure Ambassador Hotel and Residences Seoul Yongsan
  'C3E4', // Grand Mercure Imperial Palace Seoul Gangnam
  'A5U6', // Novotel Ambassador Seoul Dongdaemun Hotels & Residences
  '1633', // Novotel Ambassador Seoul Gangnam
  '9472', // Novotel Ambassador Seoul Yongsan - Seoul Dragon City
  '9473', // Novotel Suites Ambassador Seoul Yongsan
  'B220', // Sofitel Ambassador Seoul Hotel & Serviced Residences
  '0966', // The Ambassador Seoul - A Pullman Hotel
  '8748', // Novotel Ambassador Suwon
  // Thailand (18 hotels)
  'C0Y8', // Grand Mercure Bangkok Atrium
  '8422', // Mercure Bangkok Makkasan
  'A247', // Mercure Bangkok Sukhumvit 11
  'B4U9', // Mövenpick BDMS Wellness Resort Bangkok
  'B4U9', // Mövenpick BDMS Wellness Resort Bangkok
  'B4K2', // Mövenpick Hotel Sukhumvit 15 Bangkok
  'B346', // Novotel Bangkok Future Park Rangsit
  '8059', // Novotel Bangkok Impact
  '7272', // Novotel Bangkok Platinum Pratunam
  '9343', // Novotel Bangkok Sukhumvit 20
  '3616', // Pullman Bangkok Hotel G
  '6323', // Pullman Bangkok King Power
  '5213', // Sofitel Bangkok Sukhumvit
  '9775', // Novotel Marina Sriracha
  '6184', // Sofitel Krabi Phokeethra Golf & Spa Resort
  '7540', // Pullman Pattaya Hotel G
  '8109', // Grand Mercure Phuket Patong
  'C1D6', // Pullman Phuket Karon Beach
  // Vietnam (13 hotels)
  '7821', // Grand Mercure Danang
  '8287', // Novotel Danang Premier Han River
  'B4G6', // Movenpick Hotel Hanoi Centre
  '9183', // Mercure Hai Phong
  '7579', // Pullman Hanoi
  'B4S6', // Pullman Hai Phong Grand Hotel
  '1555', // Sofitel Legend Metropole Hanoi
  '9231', // Hotel des Arts Saigon - MGallery Collection
  '7965', // Novotel Saigon Centre
  '7489', // Pullman Saigon Centre
  '2077', // Sofitel Saigon Plaza
  'B6Y9', // Mövenpick Resort Phan Thiet
  '7133', // Pullman Vung Tau

  // ===== EUROPE =====
  // Czech Republic (1 hotels)
  '7051', // Mercure Ostrava Center
  // Greece (1 hotels)
  '3167', // Sofitel Athens Airport
  // Hungary (1 hotels)
  '6565', // Mercure Budapest City Center
  // Netherlands (1 hotels)
  'B4I7', // Mövenpick Hotel Amsterdam City Centre
  // Turkey (3 hotels)
  'A800', // Fairmont Quasar Istanbul
  'A5D2', // Swissôtel The Bosphorus Istanbul
  'A5A6', // Swissôtel Büyük Efes
  // United Kingdom (1 hotels)
  '6214', // Sofitel London Heathrow Hotel

  // ===== MIDDLE EAST =====
  // Bahrain (1 hotels)
  '6722', // Sofitel Bahrain Zallaq Thalassa sea & spa
  // Egypt (3 hotels)
  'A5E9', // Fairmont Nile City
  'C3J2', // Sofitel Cairo Downtown Nile
  '5307', // Sofitel Cairo Nile El Gezirah
  // Jordan (2 hotels)
  'A7X8', // Fairmont Amman
  'B5J0', // Movenpick Hotel Amman
  // Qatar (3 hotels)
  'B4T9', // Banyan Tree Doha at La Cigale Musharib
  'B663', // Fairmont Doha
  '8112', // Pullman Doha West Bay
  // Saudi Arabia (6 hotels)
  '5988', // Sofitel Al Khobar The Corniche
  'B4M6', // Anwar Al Madinah Mövenpick Hotel
  'B4M6', // Anwar Al Madinah Movenpick Hotel
  'B4N1', // Mövenpick Qassim
  'A7X6', // Fairmont Riyadh
  '9029', // Sofitel Riyadh
  // United Arab Emirates (15 hotels)
  '7507', // Sofitel Abu Dhabi Corniche
  'A5F1', // Fairmont The Palm
  'B4J9', // Grand Plaza Movenpick Media City
  'B4J9', // Grand Plaza Mövenpick Media City
  'A7N4', // Mercure Dubai Deira
  'B4J0', // Mövenpick Hotel & Apartments Bur Dubai
  'B4I9', // Mövenpick Hotel Jumeirah Beach
  'B8D7', // Pullman Dubai Downtown
  'B8D7', // Pullman Dubai Downtown
  '6305', // Pullman Dubai Jumeirah Lakes Towers
  '7492', // Sofitel Dubai Downtown
  '6146', // Sofitel Dubai Jumeirah Beach
  'B197', // Sofitel Dubai The Obelisk
  'B1P8', // Swissotel Al Ghurair Dubai
  'B9F8', // Sofitel Al Hamra Beach Resort

  // ===== NORTH AMERICA =====
  // Canada (12 hotels)
  'A550', // Fairmont Banff Springs
  'A555', // Fairmont Palliser
  'A559', // Fairmont Hotel Macdonald
  'A563', // Fairmont Chateau Lake Louise
  'A567', // Fairmont The Queen Elizabeth
  'A551', // Fairmont Royal York
  'A565', // Fairmont Tremblant
  'A584', // Fairmont Hotel Vancouver
  'A585', // Fairmont Pacific Rim
  'A587', // Fairmont Waterfront
  'A591', // Fairmont Chateau Whistler
  'A592', // Fairmont Winnipeg
  // Mexico (1 hotels)
  '9615', // Sofitel Mexico City Reforma
  // United States Of America (8 hotels)
  'A7Z4', // Fairmont Austin
  'A554', // Fairmont Copley Plaza
  'A557', // Fairmont Chicago, Millennium Park
  'A558', // Fairmont Dallas
  'A561', // Fairmont Orchid Hawaii
  'A8J5', // Fairmont Century Plaza
  'A579', // Fairmont Scottsdale Princess
  'A590', // Fairmont Washington D.C. Georgetown

  // ===== OCEANIA =====
  // Australia (9 hotels)
  'B217', // Pullman Adelaide
  '5992', // Sofitel Brisbane Central
  'C074', // The Sebel Twin Towns Coolangatta
  '3028', // Pullman Melbourne City Centre
  '9875', // Pullman Melbourne On the Park
  '1902', // Sofitel Melbourne on Collins
  '9729', // Sofitel Sydney Darling Harbour
  '3665', // Sofitel Sydney Wentworth
  'A5D0', // Swissôtel Sydney
  // New Zealand (1 hotels)
  'A8U9', // Pullman Auckland

  // ===== SOUTH AMERICA =====
  // Brazil (2 hotels)
  '3575', // Mercure Belo Horizonte Lourdes
  '1988', // Fairmont Rio de Janeiro Copacabana
  // Ecuador (1 hotels)
  'A5C4', // Swissôtel Quito
  // Peru (2 hotels)
  '6339', // Novotel Lima
  'A5B8', // Swissôtel Lima

  // ===== UNMATCHED HOTELS (58 hotels) =====
  // These hotels could not be matched via the API.
  // Search manually on all.accor.com and inspect data-hotel-id attribute.
  // TODO: Resolve remaining 58 unmatched hotel IDs
]);

// Hotel IDs offering complimentary breakfast for Platinum/Diamond members.
// Populated from data/breakfast/YYYY-MM.json via Bookmarklet 2.
// TODO: Run "Extract All Breakfast Hotels" bookmarklet and populate (~7,400+ hotels)
const FREE_BREAKFAST_HOTEL_IDS = new Set([
  // 3759 hotels from data/breakfast/2026-03.json (7403 total, 3759 unique IDs)
  // Updated: 2026-02-27
  '0338', '0340', '0341', '0343', '0344', '0345', '0348', '0351', '0354', '0355',
  '0356', '0357', '0358', '0360', '0363', '0364', '0369', '0370', '0372', '0373',
  '0374', '0375', '0376', '0379', '0380', '0382', '0383', '0384', '0385', '0386',
  '0387', '0388', '0389', '0390', '0392', '0393', '0394', '0395', '0396', '0398',
  '0402', '0403', '0405', '0407', '0410', '0412', '0413', '0414', '0418', '0419',
  '0421', '0423', '0424', '0426', '0427', '0428', '0430', '0431', '0432', '0433',
  '0436', '0438', '0439', '0440', '0444', '0445', '0446', '0449', '0450', '0452',
  '0455', '0456', '0459', '0460', '0465', '0467', '0471', '0472', '0473', '0477',
  '0478', '0481', '0482', '0483', '0491', '0492', '0493', '0497', '0498', '0500',
  '0506', '0507', '0511', '0515', '0517', '0519', '0523', '0525', '0527', '0528',
  '0529', '0530', '0531', '0538', '0540', '0542', '0549', '0550', '0551', '0553',
  '0557', '0561', '0563', '0565', '0568', '0569', '0577', '0578', '0579', '0581',
  '0587', '0589', '0592', '0603', '0605', '0607', '0608', '0609', '0610', '0611',
  '0612', '0613', '0616', '0617', '0618', '0620', '0621', '0622', '0623', '0624',
  '0625', '0627', '0628', '0629', '0633', '0634', '0635', '0636', '0637', '0638',
  '0639', '0640', '0643', '0644', '0646', '0647', '0649', '0650', '0652', '0653',
  '0657', '0659', '0663', '0667', '0668', '0669', '0670', '0671', '0674', '0683',
  '0684', '0686', '0687', '0688', '0689', '0691', '0692', '0694', '0695', '0697',
  '0698', '0699', '0700', '0704', '0705', '0707', '0708', '0709', '0711', '0714',
  '0715', '0716', '0718', '0723', '0725', '0728', '0732', '0733', '0736', '0737',
  '0738', '0739', '0740', '0741', '0743', '0747', '0749', '0750', '0752', '0756',
  '0771', '0776', '0778', '0779', '0781', '0784', '0785', '0786', '0792', '0793',
  '0794', '0795', '0796', '0797', '0798', '0799', '0800', '0801', '0802', '0803',
  '0811', '0814', '0816', '0819', '0822', '0828', '0831', '0839', '0840', '0843',
  '0848', '0850', '0851', '0852', '0855', '0856', '0858', '0861', '0862', '0863',
  '0864', '0866', '0869', '0873', '0878', '0881', '0882', '0884', '0888', '0889',
  '0890', '0892', '0900', '0901', '0902', '0903', '0904', '0905', '0906', '0907',
  '0908', '0909', '0910', '0911', '0912', '0918', '0920', '0923', '0925', '0927',
  '0928', '0929', '0930', '0931', '0933', '0934', '0935', '0937', '0943', '0944',
  '0947', '0948', '0949', '0950', '0951', '0952', '0956', '0959', '0960', '0961',
  '0962', '0964', '0965', '0966', '0967', '0971', '0972', '0973', '0974', '0975',
  '0976', '0977', '0978', '0981', '0982', '0984', '0985', '0986', '0991', '0994',
  '0995', '1014', '1016', '1022', '1023', '1028', '1030', '1031', '1033', '1034',
  '1037', '1039', '1040', '1042', '1046', '1047', '1049', '1050', '1051', '1055',
  '1056', '1068', '1069', '1071', '1072', '1073', '1075', '1077', '1080', '1081',
  '1084', '1090', '1092', '1093', '1096', '1098', '1099', '1102', '1103', '1104',
  '1105', '1106', '1108', '1109', '1118', '1120', '1122', '1123', '1130', '1131',
  '1132', '1134', '1137', '1139', '1142', '1143', '1146', '1147', '1148', '1151',
  '1153', '1158', '1159', '1160', '1163', '1168', '1169', '1170', '1171', '1172',
  '1175', '1176', '1177', '1178', '1180', '1183', '1185', '1187', '1188', '1190',
  '1191', '1192', '1193', '1195', '1199', '1200', '1204', '1206', '1211', '1212',
  '1213', '1215', '1217', '1220', '1223', '1227', '1230', '1233', '1239', '1241',
  '1244', '1245', '1246', '1249', '1251', '1260', '1263', '1264', '1269', '1273',
  '1274', '1275', '1276', '1281', '1282', '1284', '1292', '1294', '1295', '1296',
  '1298', '1300', '1301', '1302', '1306', '1307', '1310', '1312', '1313', '1314',
  '1315', '1317', '1319', '1322', '1348', '1356', '1357', '1358', '1361', '1362',
  '1363', '1364', '1369', '1370', '1371', '1374', '1377', '1380', '1388', '1390',
  '1391', '1393', '1394', '1395', '1396', '1398', '1399', '1400', '1401', '1404',
  '1407', '1409', '1413', '1414', '1420', '1421', '1423', '1424', '1428', '1429',
  '1430', '1431', '1438', '1439', '1445', '1447', '1449', '1450', '1453', '1454',
  '1455', '1457', '1458', '1459', '1461', '1508', '1514', '1535', '1536', '1537',
  '1539', '1540', '1541', '1544', '1545', '1546', '1549', '1552', '1554', '1555',
  '1556', '1557', '1559', '1560', '1561', '1563', '1565', '1568', '1571', '1572',
  '1574', '1578', '1582', '1584', '1585', '1586', '1588', '1589', '1593', '1596',
  '1598', '1601', '1608', '1609', '1614', '1621', '1622', '1623', '1624', '1625',
  '1627', '1628', '1633', '1636', '1637', '1639', '1640', '1641', '1643', '1648',
  '1659', '1661', '1662', '1666', '1668', '1672', '1675', '1678', '1681', '1682',
  '1686', '1687', '1688', '1689', '1697', '1702', '1708', '1709', '1714', '1715',
  '1720', '1729', '1730', '1732', '1735', '1738', '1740', '1742', '1743', '1748',
  '1754', '1755', '1759', '1761', '1764', '1765', '1769', '1773', '1783', '1785',
  '1788', '1797', '1798', '1802', '1803', '1810', '1813', '1814', '1815', '1822',
  '1823', '1826', '1827', '1833', '1834', '1871', '1875', '1877', '1888', '1889',
  '1894', '1903', '1904', '1909', '1913', '1922', '1930', '1936', '1937', '1940',
  '1951', '1952', '1961', '1964', '1965', '1966', '1971', '1974', '1975', '1976',
  '1978', '1979', '1980', '1982', '1985', '1987', '1989', '2004', '2012', '2013',
  '2022', '2023', '2025', '2027', '2029', '2033', '2034', '2035', '2039', '2041',
  '2042', '2043', '2049', '2051', '2053', '2057', '2059', '2076', '2077', '2078',
  '2082', '2088', '2091', '2093', '2094', '2109', '2117', '2122', '2125', '2126',
  '2127', '2128', '2129', '2149', '2154', '2160', '2161', '2163', '2167', '2169',
  '2171', '2175', '2176', '2177', '2179', '2182', '2183', '2185', '2186', '2189',
  '2190', '2192', '2195', '2197', '2203', '2205', '2206', '2211', '2217', '2547',
  '2637', '2731', '2736', '2737', '2741', '2748', '2751', '2768', '2772', '2773',
  '2783', '2789', '2792', '2793', '2799', '2812', '2814', '2816', '2820', '2846',
  '2876', '2891', '2894', '2897', '2898', '2900', '2904', '2905', '2906', '2907',
  '2909', '2917', '2918', '2919', '2922', '2924', '2927', '2937', '2939', '2941',
  '2942', '2945', '2947', '2948', '2949', '2950', '2951', '2953', '2955', '2960',
  '2962', '2967', '2980', '2981', '2982', '2992', '2993', '2994', '2996', '2997',
  '3004', '3006', '3013', '3018', '3019', '3043', '3044', '3050', '3054', '3061',
  '3096', '3099', '3107', '3110', '3114', '3118', '3120', '3123', '3124', '3127',
  '3128', '3129', '3132', '3133', '3134', '3135', '3136', '3137', '3139', '3140',
  '3141', '3143', '3144', '3147', '3150', '3151', '3152', '3153', '3154', '3155',
  '3165', '3167', '3168', '3172', '3173', '3194', '3195', '3197', '3199', '3200',
  '3201', '3204', '3205', '3206', '3207', '3208', '3210', '3211', '3220', '3221',
  '3225', '3227', '3230', '3232', '3239', '3243', '3250', '3251', '3254', '3255',
  '3258', '3261', '3262', '3263', '3264', '3265', '3267', '3269', '3270', '3271',
  '3272', '3278', '3279', '3280', '3282', '3283', '3284', '3285', '3289', '3292',
  '3293', '3296', '3297', '3298', '3303', '3304', '3305', '3306', '3307', '3309',
  '3310', '3311', '3312', '3316', '3318', '3320', '3321', '3324', '3325', '3334',
  '3338', '3340', '3341', '3344', '3346', '3347', '3355', '3357', '3359', '3362',
  '3365', '3367', '3368', '3369', '3372', '3373', '3374', '3375', '3376', '3377',
  '3378', '3383', '3384', '3385', '3390', '3391', '3393', '3401', '3403', '3404',
  '3405', '3406', '3407', '3408', '3417', '3419', '3420', '3421', '3429', '3433',
  '3435', '3436', '3437', '3440', '3443', '3444', '3448', '3449', '3450', '3452',
  '3454', '3458', '3460', '3467', '3473', '3475', '3476', '3479', '3480', '3511',
  '3518', '3531', '3533', '3535', '3537', '3538', '3539', '3543', '3546', '3549',
  '3550', '3551', '3557', '3559', '3560', '3561', '3562', '3563', '3566', '3569',
  '3572', '3575', '3576', '3577', '3600', '3601', '3610', '3616', '3624', '3625',
  '3626', '3627', '3632', '3637', '3646', '3652', '3653', '3655', '3656', '3657',
  '3667', '3670', '3672', '3676', '3677', '3679', '3680', '3683', '3697', '3700',
  '3701', '3709', '3710', '3713', '3714', '3716', '3718', '3720', '3724', '3728',
  '3730', '3732', '3733', '3735', '3736', '3737', '3744', '3745', '3747', '3752',
  '3753', '3755', '3757', '3758', '4986', '4987', '4990', '4993', '5006', '5007',
  '5008', '5009', '5011', '5021', '5031', '5038', '5039', '5040', '5046', '5060',
  '5091', '5111', '5140', '5141', '5168', '5170', '5173', '5174', '5176', '5182',
  '5209', '5210', '5211', '5213', '5221', '5223', '5224', '5229', '5233', '5234',
  '5236', '5239', '5240', '5242', '5258', '5261', '5270', '5275', '5282', '5297',
  '5298', '5300', '5302', '5307', '5309', '5323', '5324', '5326', '5338', '5341',
  '5347', '5356', '5357', '5358', '5364', '5366', '5371', '5372', '5373', '5374',
  '5375', '5376', '5379', '5381', '5383', '5389', '5390', '5391', '5394', '5396',
  '5400', '5402', '5410', '5413', '5418', '5425', '5431', '5432', '5440', '5445',
  '5451', '5460', '5461', '5463', '5465', '5467', '5468', '5470', '5471', '5473',
  '5474', '5477', '5478', '5479', '5484', '5506', '5511', '5520', '5525', '5526',
  '5528', '5530', '5532', '5534', '5541', '5542', '5543', '5546', '5547', '5554',
  '5555', '5556', '5558', '5560', '5562', '5563', '5585', '5586', '5587', '5604',
  '5611', '5612', '5613', '5614', '5615', '5616', '5622', '5623', '5624', '5625',
  '5628', '5631', '5633', '5640', '5641', '5645', '5646', '5650', '5654', '5670',
  '5671', '5672', '5681', '5690', '5691', '5692', '5693', '5694', '5703', '5704',
  '5708', '5712', '5742', '5914', '5921', '5932', '5934', '5944', '5946', '5947',
  '5949', '5951', '5954', '5955', '5970', '5971', '5973', '5974', '5981', '5982',
  '5988', '5997', '5998', '6000', '6011', '6017', '6030', '6033', '6035', '6036',
  '6141', '6144', '6145', '6146', '6148', '6151', '6154', '6155', '6156', '6160',
  '6162', '6166', '6169', '6177', '6179', '6181', '6182', '6184', '6185', '6186',
  '6187', '6188', '6189', '6190', '6204', '6206', '6214', '6218', '6231', '6232',
  '6233', '6234', '6237', '6238', '6239', '6243', '6245', '6284', '6289', '6290',
  '6301', '6303', '6305', '6306', '6308', '6313', '6315', '6317', '6318', '6323',
  '6324', '6328', '6330', '6332', '6339', '6342', '6348', '6351', '6355', '6357',
  '6359', '6361', '6363', '6367', '6390', '6398', '6401', '6410', '6443', '6444',
  '6445', '6448', '6451', '6453', '6454', '6455', '6467', '6469', '6473', '6479',
  '6480', '6481', '6482', '6491', '6492', '6493', '6495', '6497', '6502', '6503',
  '6510', '6513', '6514', '6515', '6516', '6517', '6518', '6519', '6520', '6522',
  '6523', '6526', '6528', '6529', '6530', '6532', '6533', '6535', '6537', '6538',
  '6539', '6541', '6543', '6546', '6549', '6550', '6552', '6553', '6556', '6564',
  '6565', '6567', '6572', '6573', '6583', '6587', '6589', '6593', '6599', '6600',
  '6601', '6603', '6606', '6616', '6617', '6624', '6628', '6630', '6631', '6643',
  '6644', '6647', '6648', '6653', '6657', '6661', '6663', '6664', '6665', '6668',
  '6670', '6680', '6684', '6685', '6687', '6688', '6693', '6694', '6707', '6710',
  '6711', '6714', '6715', '6722', '6734', '6752', '6759', '6772', '6775', '6776',
  '6777', '6784', '6786', '6787', '6788', '6789', '6790', '6791', '6793', '6794',
  '6796', '6797', '6798', '6799', '6811', '6812', '6813', '6814', '6817', '6818',
  '6819', '6824', '6826', '6833', '6834', '6835', '6843', '6851', '6857', '6864',
  '6865', '6866', '6867', '6868', '6889', '6903', '6904', '6905', '6913', '6914',
  '6915', '6916', '6925', '6926', '6928', '6930', '6936', '6937', '6939', '6940',
  '6945', '6948', '6949', '6960', '6963', '6965', '6971', '6972', '6985', '6987',
  '6988', '6995', '7000', '7002', '7003', '7012', '7013', '7014', '7016', '7019',
  '7020', '7021', '7023', '7025', '7026', '7039', '7049', '7050', '7051', '7057',
  '7060', '7071', '7076', '7080', '7082', '7087', '7089', '7090', '7091', '7115',
  '7118', '7121', '7122', '7123', '7125', '7126', '7131', '7133', '7135', '7143',
  '7147', '7148', '7152', '7155', '7157', '7161', '7163', '7165', '7177', '7186',
  '7191', '7200', '7205', '7206', '7211', '7216', '7229', '7231', '7232', '7233',
  '7234', '7235', '7236', '7237', '7238', '7239', '7240', '7242', '7253', '7260',
  '7272', '7273', '7276', '7285', '7286', '7287', '7288', '7289', '7290', '7293',
  '7295', '7296', '7297', '7298', '7309', '7318', '7324', '7325', '7326', '7327',
  '7329', '7332', '7341', '7342', '7347', '7360', '7361', '7363', '7367', '7377',
  '7378', '7379', '7380', '7381', '7383', '7385', '7386', '7391', '7392', '7402',
  '7427', '7431', '7435', '7436', '7437', '7438', '7441', '7443', '7447', '7451',
  '7456', '7460', '7468', '7483', '7484', '7488', '7489', '7490', '7491', '7492',
  '7507', '7535', '7536', '7537', '7538', '7540', '7545', '7547', '7548', '7552',
  '7557', '7559', '7560', '7563', '7564', '7565', '7567', '7571', '7577', '7579',
  '7585', '7588', '7589', '7598', '7606', '7813', '7819', '7821', '7823', '7825',
  '7826', '7827', '7828', '7830', '7832', '7838', '7840', '7847', '7848', '7853',
  '7854', '7855', '7867', '7870', '7872', '7873', '7926', '7928', '7933', '7934',
  '7935', '7942', '7943', '7946', '7947', '7948', '7951', '7961', '7965', '7969',
  '7970', '7997', '8002', '8006', '8007', '8015', '8016', '8017', '8018', '8020',
  '8028', '8030', '8032', '8052', '8057', '8059', '8060', '8061', '8062', '8069',
  '8074', '8075', '8087', '8089', '8091', '8092', '8096', '8098', '8099', '8100',
  '8102', '8108', '8109', '8112', '8115', '8117', '8120', '8131', '8134', '8135',
  '8138', '8139', '8140', '8142', '8151', '8154', '8158', '8159', '8160', '8163',
  '8164', '8167', '8173', '8175', '8176', '8177', '8180', '8182', '8188', '8196',
  '8212', '8215', '8216', '8220', '8227', '8232', '8244', '8258', '8273', '8274',
  '8275', '8276', '8279', '8287', '8288', '8301', '8307', '8308', '8309', '8310',
  '8320', '8321', '8322', '8323', '8325', '8327', '8329', '8331', '8332', '8334',
  '8335', '8336', '8342', '8343', '8344', '8350', '8351', '8353', '8355', '8361',
  '8362', '8364', '8365', '8366', '8367', '8368', '8377', '8378', '8382', '8383',
  '8384', '8385', '8386', '8388', '8395', '8398', '8399', '8400', '8401', '8402',
  '8406', '8412', '8413', '8417', '8420', '8422', '8431', '8436', '8441', '8445',
  '8446', '8447', '8448', '8450', '8455', '8457', '8463', '8468', '8474', '8475',
  '8484', '8487', '8488', '8489', '8491', '8498', '8500', '8501', '8502', '8505',
  '8509', '8510', '8516', '8518', '8519', '8521', '8523', '8527', '8528', '8529',
  '8535', '8539', '8541', '8548', '8549', '8552', '8557', '8562', '8564', '8565',
  '8570', '8571', '8576', '8582', '8584', '8593', '8600', '8601', '8602', '8603',
  '8622', '8624', '8627', '8629', '8637', '8638', '8643', '8644', '8645', '8646',
  '8647', '8649', '8652', '8654', '8657', '8664', '8665', '8668', '8674', '8696',
  '8719', '8725', '8728', '8729', '8732', '8737', '8740', '8748', '8750', '8754',
  '8770', '8775', '8807', '8808', '8814', '8816', '8817', '8824', '8826', '8837',
  '8838', '8842', '8844', '8865', '8866', '8873', '8875', '8876', '8885', '8886',
  '8889', '8894', '8900', '8902', '8906', '8908', '8911', '8913', '8923', '8924',
  '8932', '8938', '8941', '8954', '8967', '8968', '8983', '8984', '8985', '8986',
  '8987', '8988', '8989', '8996', '8999', '9008', '9009', '9013', '9019', '9021',
  '9029', '9037', '9045', '9048', '9054', '9057', '9060', '9061', '9063', '9068',
  '9069', '9076', '9078', '9096', '9099', '9101', '9103', '9104', '9105', '9109',
  '9112', '9113', '9115', '9121', '9126', '9131', '9137', '9138', '9147', '9156',
  '9159', '9160', '9162', '9165', '9167', '9171', '9172', '9174', '9183', '9196',
  '9213', '9214', '9216', '9221', '9224', '9227', '9229', '9231', '9233', '9238',
  '9239', '9244', '9245', '9249', '9267', '9268', '9274', '9278', '9279', '9280',
  '9282', '9283', '9289', '9292', '9296', '9297', '9298', '9299', '9300', '9301',
  '9302', '9306', '9307', '9308', '9309', '9319', '9320', '9321', '9325', '9332',
  '9336', '9338', '9339', '9343', '9346', '9352', '9371', '9374', '9379', '9389',
  '9395', '9397', '9400', '9411', '9414', '9416', '9417', '9418', '9422', '9436',
  '9441', '9442', '9444', '9448', '9450', '9452', '9462', '9468', '9469', '9470',
  '9472', '9473', '9474', '9475', '9482', '9495', '9507', '9510', '9527', '9531',
  '9543', '9547', '9548', '9551', '9553', '9554', '9561', '9567', '9570', '9577',
  '9578', '9580', '9581', '9590', '9595', '9598', '9607', '9608', '9617', '9618',
  '9619', '9620', '9622', '9627', '9633', '9634', '9636', '9637', '9641', '9649',
  '9652', '9654', '9662', '9663', '9669', '9671', '9674', '9676', '9677', '9680',
  '9685', '9688', '9692', '9698', '9703', '9704', '9706', '9707', '9714', '9715',
  '9720', '9721', '9728', '9730', '9731', '9734', '9737', '9739', '9745', '9746',
  '9747', '9757', '9758', '9770', '9771', '9772', '9776', '9778', '9779', '9781',
  '9783', '9788', '9790', '9793', '9799', '9800', '9804', '9806', '9807', '9808',
  '9813', '9817', '9823', '9824', '9832', '9834', '9835', '9837', '9844', '9861',
  '9871', '9872', '9884', '9896', '9898', '9900', '9914', '9920', '9921', '9922',
  '9923', '9924', '9928', '9929', '9932', '9933', '9936', '9939', '9958', '9959',
  '9960', '9961', '9964', 'A002', 'A009', 'A011', 'A013', 'A016', 'A024', 'A025',
  'A026', 'A027', 'A033', 'A034', 'A035', 'A038', 'A040', 'A044', 'A052', 'A054',
  'A057', 'A070', 'A072', 'A073', 'A074', 'A088', 'A089', 'A094', 'A095', 'A099',
  'A0A4', 'A0C5', 'A0C7', 'A0D2', 'A0D3', 'A0D7', 'A0D8', 'A0E9', 'A0G2', 'A0G3',
  'A0G4', 'A0H4', 'A0H8', 'A0I0', 'A0I7', 'A0K9', 'A0L1', 'A0R4', 'A0R5', 'A0S4',
  'A0W9', 'A0X1', 'A0X2', 'A0X3', 'A0X5', 'A0Y1', 'A0Y5', 'A0Z4', 'A102', 'A103',
  'A121', 'A123', 'A145', 'A146', 'A150', 'A151', 'A152', 'A159', 'A1B8', 'A1C8',
  'A1F1', 'A1H2', 'A1H4', 'A1J0', 'A1J1', 'A1J5', 'A1K1', 'A1K2', 'A1K4', 'A1K5',
  'A1K6', 'A1L0', 'A1L2', 'A1R5', 'A1X4', 'A1X5', 'A206', 'A207', 'A208', 'A209',
  'A211', 'A219', 'A222', 'A224', 'A227', 'A228', 'A231', 'A232', 'A237', 'A238',
  'A240', 'A241', 'A242', 'A243', 'A245', 'A246', 'A247', 'A248', 'A2E5', 'A312',
  'A345', 'A347', 'A351', 'A356', 'A3J6', 'A3M7', 'A3N3', 'A3N6', 'A3N7', 'A3P2',
  'A3P3', 'A3S9', 'A413', 'A473', 'A487', 'A4A4', 'A4A5', 'A4C2', 'A4G0', 'A4N1',
  'A545', 'A547', 'A550', 'A551', 'A552', 'A554', 'A555', 'A556', 'A557', 'A558',
  'A559', 'A560', 'A561', 'A562', 'A563', 'A564', 'A565', 'A566', 'A567', 'A568',
  'A570', 'A571', 'A572', 'A573', 'A574', 'A576', 'A578', 'A579', 'A580', 'A581',
  'A584', 'A585', 'A586', 'A587', 'A588', 'A590', 'A591', 'A592', 'A599', 'A5A1',
  'A5A4', 'A5A7', 'A5D1', 'A5E1', 'A5F9', 'A5G1', 'A5G3', 'A5G5', 'A5G6', 'A5T2',
  'A5U6', 'A5U8', 'A5V2', 'A5Y7', 'A5Z8', 'A602', 'A609', 'A610', 'A611', 'A614',
  'A697', 'A6H6', 'A6I2', 'A6P9', 'A6Q0', 'A6S6', 'A6S7', 'A732', 'A741', 'A742',
  'A744', 'A780', 'A7J9', 'A7L5', 'A7L6', 'A7M8', 'A7N4', 'A7N5', 'A7N6', 'A7W6',
  'A7X0', 'A7X1', 'A7X5', 'A7Z0', 'A7Z3', 'A7Z4', 'A8E7', 'A8E8', 'A8F4', 'A8F7',
  'A8G6', 'A8J5', 'A8M7', 'A8V6', 'A8V8', 'A990', 'A9A0', 'A9A2', 'A9E9', 'A9F1',
  'A9F7', 'A9G9', 'A9N7', 'A9P1', 'A9P2', 'A9P3', 'A9P4', 'A9P7', 'A9Q6', 'A9R8',
  'A9U6', 'A9U9', 'A9V0', 'A9V3', 'A9V4', 'A9V7', 'B046', 'B061', 'B063', 'B066',
  'B068', 'B089', 'B094', 'B096', 'B0C7', 'B0C8', 'B0C9', 'B0I0', 'B0I1', 'B0I5',
  'B0I6', 'B0K0', 'B0L8', 'B0M2', 'B0M3', 'B0M5', 'B0M9', 'B0N4', 'B0P4', 'B0P5',
  'B0R0', 'B0R2', 'B0V0', 'B0X1', 'B0X3', 'B0Y0', 'B0Y2', 'B0Y3', 'B0Y8', 'B0Y9',
  'B127', 'B129', 'B130', 'B132', 'B133', 'B134', 'B137', 'B138', 'B140', 'B141',
  'B142', 'B143', 'B144', 'B145', 'B146', 'B151', 'B168', 'B1A2', 'B1A9', 'B1B7',
  'B1C0', 'B1C1', 'B1C3', 'B1D8', 'B1E0', 'B1E1', 'B1F0', 'B1F2', 'B1F4', 'B1F7',
  'B1I4', 'B1I5', 'B1J1', 'B1J6', 'B1K6', 'B1K9', 'B1L0', 'B1M5', 'B1M9', 'B1N9',
  'B1Q3', 'B1Q4', 'B1R1', 'B1R5', 'B1R6', 'B1S0', 'B1T9', 'B1U1', 'B1U4', 'B1U5',
  'B1U6', 'B1U7', 'B1U8', 'B1U9', 'B1V0', 'B1V1', 'B1V2', 'B1V4', 'B1V5', 'B1V6',
  'B1V7', 'B1V8', 'B1W0', 'B1W1', 'B1W2', 'B1W4', 'B1W5', 'B1W6', 'B1W7', 'B1W8',
  'B1W9', 'B1X1', 'B1X3', 'B1X4', 'B1X5', 'B1Y1', 'B1Y2', 'B1Y3', 'B1Y4', 'B1Y6',
  'B1Y7', 'B1Z1', 'B1Z5', 'B200', 'B201', 'B208', 'B211', 'B215', 'B218', 'B219',
  'B220', 'B261', 'B262', 'B278', 'B279', 'B281', 'B283', 'B290', 'B2A2', 'B2C7',
  'B2D8', 'B2E1', 'B2E4', 'B2E6', 'B2E7', 'B2E8', 'B2H2', 'B2H8', 'B2J7', 'B2L7',
  'B2M0', 'B2M2', 'B2M3', 'B2N6', 'B2P1', 'B2P2', 'B2P4', 'B2P6', 'B2P7', 'B2P9',
  'B2Q4', 'B2Q7', 'B2Q8', 'B2Q9', 'B2R4', 'B2R6', 'B2R7', 'B2R8', 'B2R9', 'B2S0',
  'B2S2', 'B2S9', 'B2T1', 'B2T3', 'B2T4', 'B2T5', 'B2U4', 'B2U9', 'B2V1', 'B2V5',
  'B2V8', 'B2W0', 'B2W3', 'B2W4', 'B2W9', 'B2X3', 'B2X4', 'B2X6', 'B2Z3', 'B311',
  'B319', 'B320', 'B321', 'B325', 'B330', 'B331', 'B337', 'B338', 'B339', 'B344',
  'B346', 'B355', 'B364', 'B366', 'B367', 'B371', 'B374', 'B385', 'B388', 'B394',
  'B395', 'B3B1', 'B3B6', 'B3C1', 'B3C2', 'B3D0', 'B3D3', 'B3F6', 'B3F7', 'B3F9',
  'B3G0', 'B3G1', 'B3G3', 'B3H1', 'B3H3', 'B3H4', 'B3H6', 'B3L6', 'B3V7', 'B3W0',
  'B3W1', 'B3W2', 'B3X2', 'B3X3', 'B3X8', 'B3X9', 'B3Y0', 'B3Y4', 'B3Z6', 'B404',
  'B405', 'B412', 'B426', 'B427', 'B430', 'B432', 'B434', 'B436', 'B442', 'B448',
  'B449', 'B464', 'B472', 'B478', 'B485', 'B493', 'B4A2', 'B4A3', 'B4A5', 'B4B1',
  'B4B2', 'B4B9', 'B4C0', 'B4C3', 'B4C5', 'B4C6', 'B4D2', 'B4D3', 'B4D5', 'B4D9',
  'B4E1', 'B4E3', 'B4E5', 'B4F3', 'B4F4', 'B4F6', 'B4F8', 'B4G0', 'B4G1', 'B4G5',
  'B4G6', 'B4G7', 'B4G8', 'B4G9', 'B4H0', 'B4H1', 'B4H3', 'B4H5', 'B4H6', 'B4H9',
  'B4I0', 'B4I1', 'B4I2', 'B4I3', 'B4I4', 'B4I5', 'B4I7', 'B4I9', 'B4J0', 'B4J2',
  'B4J4', 'B4J7', 'B4J8', 'B4J9', 'B4K4', 'B4K6', 'B4K7', 'B4L3', 'B4L8', 'B4M0',
  'B4M2', 'B4M6', 'B4N1', 'B4N2', 'B4N3', 'B4N6', 'B4N7', 'B4N9', 'B4P0', 'B4P2',
  'B4P3', 'B4P4', 'B4P6', 'B4P8', 'B4P9', 'B4Q0', 'B4Q1', 'B4Q3', 'B4Q4', 'B4Q6',
  'B4Q7', 'B4Q8', 'B4R7', 'B4R9', 'B4S0', 'B4S1', 'B4S4', 'B4S6', 'B4S9', 'B4T0',
  'B4T3', 'B4T5', 'B4T9', 'B4U5', 'B4U6', 'B4U7', 'B4U9', 'B4W0', 'B4W2', 'B4X1',
  'B4X4', 'B4Y2', 'B4Y6', 'B4Z1', 'B4Z2', 'B4Z4', 'B4Z5', 'B4Z7', 'B4Z8', 'B535',
  'B537', 'B538', 'B539', 'B540', 'B541', 'B547', 'B549', 'B551', 'B552', 'B556',
  'B561', 'B575', 'B579', 'B580', 'B585', 'B597', 'B599', 'B5A2', 'B5B0', 'B5B2',
  'B5C8', 'B5D3', 'B5D4', 'B5E0', 'B5E3', 'B5E4', 'B5E5', 'B5E6', 'B5F4', 'B5F6',
  'B5H4', 'B5H9', 'B5I0', 'B5I7', 'B5I8', 'B5I9', 'B5J0', 'B5J1', 'B5J5', 'B5J7',
  'B5J8', 'B5K2', 'B5K3', 'B5K5', 'B5L0', 'B5L3', 'B5L4', 'B5L5', 'B5L7', 'B5M1',
  'B5M2', 'B5M3', 'B5M5', 'B5M6', 'B5N1', 'B5N9', 'B5Q2', 'B5Q6', 'B5Q7', 'B5Q9',
  'B5R3', 'B5R5', 'B5R8', 'B5V4', 'B5V6', 'B5V7', 'B5V9', 'B5W1', 'B5W4', 'B5W6',
  'B5W9', 'B5X1', 'B5X2', 'B5Y6', 'B5Y7', 'B5Y9', 'B5Z0', 'B5Z3', 'B5Z5', 'B5Z8',
  'B609', 'B628', 'B631', 'B635', 'B636', 'B637', 'B638', 'B653', 'B654', 'B655',
  'B660', 'B661', 'B662', 'B663', 'B664', 'B665', 'B666', 'B667', 'B669', 'B670',
  'B671', 'B674', 'B675', 'B677', 'B681', 'B682', 'B687', 'B692', 'B695', 'B696',
  'B697', 'B698', 'B6A0', 'B6A4', 'B6A5', 'B6A9', 'B6B0', 'B6B3', 'B6B4', 'B6C1',
  'B6D3', 'B6D9', 'B6E3', 'B6F4', 'B6F6', 'B6F7', 'B6F9', 'B6G0', 'B6G4', 'B6H3',
  'B6I1', 'B6I2', 'B6I5', 'B6I6', 'B6I8', 'B6I9', 'B6J0', 'B6K7', 'B6M3', 'B6M4',
  'B6N1', 'B6N3', 'B6N4', 'B6P4', 'B6Q0', 'B6Q8', 'B6Q9', 'B6R0', 'B6R1', 'B6R2',
  'B6R4', 'B6R8', 'B6S4', 'B6S6', 'B6S8', 'B6T0', 'B6T3', 'B6T8', 'B6T9', 'B6U1',
  'B6U2', 'B6U8', 'B6V1', 'B6V2', 'B6V3', 'B6V4', 'B6V5', 'B6V6', 'B6V7', 'B6W8',
  'B6X0', 'B6X1', 'B6X3', 'B6X6', 'B6Y6', 'B6Y9', 'B6Z0', 'B6Z1', 'B6Z2', 'B6Z8',
  'B700', 'B702', 'B705', 'B709', 'B711', 'B713', 'B714', 'B716', 'B717', 'B730',
  'B731', 'B733', 'B736', 'B737', 'B738', 'B740', 'B742', 'B743', 'B744', 'B749',
  'B750', 'B752', 'B757', 'B759', 'B762', 'B764', 'B772', 'B773', 'B775', 'B776',
  'B777', 'B780', 'B795', 'B797', 'B7A6', 'B7A7', 'B7A8', 'B7A9', 'B7B0', 'B7B1',
  'B7B2', 'B7B3', 'B7B5', 'B7C8', 'B7D0', 'B7D4', 'B7D6', 'B7D7', 'B7F8', 'B7G2',
  'B7G3', 'B7G5', 'B7G7', 'B7H3', 'B7H4', 'B7H8', 'B7I3', 'B7J3', 'B7K8', 'B7M1',
  'B7M2', 'B7M3', 'B7M4', 'B7M5', 'B7M6', 'B7M7', 'B7M8', 'B7N1', 'B7N2', 'B7N3',
  'B7N7', 'B7P1', 'B7Q0', 'B7Q1', 'B7Q2', 'B7R0', 'B7R5', 'B7R7', 'B7S4', 'B7S9',
  'B7T0', 'B7T4', 'B7T5', 'B7T7', 'B7T8', 'B7U3', 'B7U4', 'B7U5', 'B7U6', 'B7W1',
  'B7Z8', 'B7Z9', 'B801', 'B802', 'B803', 'B804', 'B814', 'B821', 'B824', 'B825',
  'B826', 'B827', 'B828', 'B829', 'B831', 'B834', 'B836', 'B839', 'B840', 'B842',
  'B845', 'B850', 'B851', 'B852', 'B853', 'B854', 'B856', 'B857', 'B858', 'B862',
  'B866', 'B868', 'B870', 'B875', 'B876', 'B879', 'B881', 'B883', 'B884', 'B886',
  'B887', 'B890', 'B893', 'B895', 'B897', 'B8A6', 'B8B1', 'B8B5', 'B8B6', 'B8C1',
  'B8C5', 'B8D0', 'B8D7', 'B8D8', 'B8D9', 'B8E3', 'B8E4', 'B8E6', 'B8E7', 'B8G4',
  'B8G5', 'B8G6', 'B8H0', 'B8H4', 'B8H6', 'B8I0', 'B8I1', 'B8I6', 'B8J0', 'B8J1',
  'B8J4', 'B8K9', 'B8L6', 'B8L7', 'B8L8', 'B8L9', 'B8M4', 'B8N0', 'B8N3', 'B8N6',
  'B8P3', 'B8P5', 'B8P6', 'B8Q0', 'B8Q2', 'B8Q3', 'B8Q5', 'B8Q7', 'B8R1', 'B8R5',
  'B8R6', 'B8R9', 'B8S1', 'B8T3', 'B8T4', 'B8T5', 'B8T6', 'B8U0', 'B8U3', 'B8U4',
  'B8U6', 'B8U7', 'B8U9', 'B8V7', 'B8W2', 'B8W6', 'B8W7', 'B8W9', 'B8X4', 'B8X5',
  'B8X6', 'B8X7', 'B8Y0', 'B8Y1', 'B8Y3', 'B8Y4', 'B8Z0', 'B8Z2', 'B8Z4', 'B8Z7',
  'B900', 'B903', 'B904', 'B907', 'B911', 'B913', 'B914', 'B917', 'B918', 'B919',
  'B921', 'B923', 'B924', 'B925', 'B928', 'B930', 'B934', 'B938', 'B939', 'B940',
  'B941', 'B943', 'B949', 'B950', 'B953', 'B956', 'B960', 'B966', 'B967', 'B970',
  'B971', 'B973', 'B986', 'B990', 'B991', 'B994', 'B998', 'B999', 'B9A3', 'B9A4',
  'B9A6', 'B9A9', 'B9B0', 'B9B1', 'B9B2', 'B9B3', 'B9B4', 'B9B5', 'B9D1', 'B9D2',
  'B9D3', 'B9D4', 'B9D8', 'B9D9', 'B9E3', 'B9E6', 'B9E8', 'B9E9', 'B9F0', 'B9F1',
  'B9F2', 'B9F3', 'B9F6', 'B9F8', 'B9G2', 'B9G3', 'B9G5', 'B9G6', 'B9G7', 'B9G8',
  'B9H0', 'B9H1', 'B9H5', 'B9H6', 'B9H7', 'B9H8', 'B9I0', 'B9I2', 'B9I7', 'B9I8',
  'B9J0', 'B9J2', 'B9J4', 'B9J5', 'B9J6', 'B9K2', 'B9K3', 'B9K7', 'B9K8', 'B9L0',
  'B9L4', 'B9L6', 'B9L7', 'B9L8', 'B9N0', 'B9N1', 'B9N4', 'B9N6', 'B9N7', 'B9N9',
  'B9P0', 'B9P3', 'B9P5', 'B9Q0', 'B9Q2', 'B9Q4', 'B9Q8', 'B9Q9', 'B9R3', 'B9R8',
  'B9R9', 'B9S6', 'B9S8', 'B9S9', 'B9T3', 'B9T5', 'B9T7', 'B9T8', 'B9U0', 'B9U3',
  'B9U8', 'B9U9', 'B9V0', 'B9W2', 'B9X1', 'B9X2', 'B9X5', 'B9X8', 'B9Y2', 'B9Y6',
  'B9Z5', 'B9Z7', 'B9Z8', 'C006', 'C007', 'C008', 'C010', 'C011', 'C013', 'C014',
  'C015', 'C016', 'C017', 'C019', 'C020', 'C025', 'C030', 'C032', 'C033', 'C037',
  'C042', 'C044', 'C048', 'C050', 'C053', 'C054', 'C056', 'C058', 'C060', 'C063',
  'C066', 'C069', 'C070', 'C076', 'C078', 'C082', 'C088', 'C089', 'C091', 'C093',
  'C096', 'C099', 'C0A1', 'C0A8', 'C0B0', 'C0B5', 'C0B6', 'C0B7', 'C0C1', 'C0C2',
  'C0C3', 'C0C5', 'C0C6', 'C0C7', 'C0D0', 'C0D4', 'C0D5', 'C0D9', 'C0E1', 'C0E3',
  'C0E4', 'C0E6', 'C0E8', 'C0F2', 'C0F3', 'C0F6', 'C0F7', 'C0G0', 'C0G1', 'C0G2',
  'C0G4', 'C0G5', 'C0G7', 'C0H0', 'C0H1', 'C0H2', 'C0H4', 'C0I0', 'C0I1', 'C0I4',
  'C0I5', 'C0J1', 'C0J3', 'C0M1', 'C0M2', 'C0M3', 'C0M4', 'C0M5', 'C0N2', 'C0N5',
  'C0Q0', 'C0Q1', 'C0Q2', 'C0Q3', 'C0Q6', 'C0Q8', 'C0Q9', 'C0R0', 'C0R7', 'C0R8',
  'C0S0', 'C0S2', 'C0S7', 'C0S8', 'C0S9', 'C0T1', 'C0T2', 'C0T5', 'C0U5', 'C0V0',
  'C0V2', 'C0V4', 'C0V5', 'C0V9', 'C0W2', 'C0W3', 'C0W4', 'C0W6', 'C0W7', 'C0Y3',
  'C0Y8', 'C0Z9', 'C100', 'C106', 'C107', 'C108', 'C118', 'C127', 'C128', 'C129',
  'C131', 'C132', 'C133', 'C138', 'C139', 'C150', 'C153', 'C160', 'C166', 'C171',
  'C173', 'C176', 'C177', 'C179', 'C181', 'C185', 'C191', 'C196', 'C1A5', 'C1A6',
  'C1A7', 'C1B0', 'C1B2', 'C1B6', 'C1B8', 'C1C3', 'C1C4', 'C1D0', 'C1D1', 'C1D3',
  'C1D6', 'C1D7', 'C1D8', 'C1E1', 'C1E4', 'C1F0', 'C1F1', 'C1F5', 'C1F6', 'C1F8',
  'C1G0', 'C1G1', 'C1H0', 'C1H4', 'C1H5', 'C1H6', 'C1H8', 'C1I0', 'C1I1', 'C1I3',
  'C1I6', 'C1I9', 'C1K3', 'C1K4', 'C1K7', 'C1M7', 'C1M8', 'C1N0', 'C1N1', 'C1N6',
  'C1N7', 'C1N8', 'C1N9', 'C1P0', 'C1P1', 'C1P2', 'C1P3', 'C1P4', 'C1P5', 'C1P6',
  'C1P7', 'C1P9', 'C1Q1', 'C1Q2', 'C1Q3', 'C1Q4', 'C1Q5', 'C1Q6', 'C1Q7', 'C1Q8',
  'C1R1', 'C1R2', 'C1R3', 'C1R7', 'C1S1', 'C1S7', 'C1T2', 'C1T5', 'C1U0', 'C1U6',
  'C1U7', 'C1U9', 'C1V2', 'C1W1', 'C1W6', 'C1W8', 'C1X0', 'C1X1', 'C1X2', 'C1X3',
  'C1X5', 'C1X6', 'C1Y8', 'C1Y9', 'C1Z1', 'C1Z6', 'C201', 'C203', 'C205', 'C206',
  'C207', 'C221', 'C222', 'C223', 'C226', 'C228', 'C229', 'C237', 'C241', 'C244',
  'C245', 'C246', 'C250', 'C252', 'C253', 'C256', 'C260', 'C261', 'C262', 'C265',
  'C266', 'C267', 'C268', 'C269', 'C270', 'C271', 'C272', 'C275', 'C278', 'C280',
  'C282', 'C283', 'C284', 'C288', 'C289', 'C291', 'C294', 'C297', 'C2A1', 'C2A2',
  'C2A3', 'C2A6', 'C2A7', 'C2B1', 'C2B4', 'C2B8', 'C2B9', 'C2C1', 'C2C8', 'C2C9',
  'C2D2', 'C2D6', 'C2E4', 'C2F2', 'C2F3', 'C2F4', 'C2F6', 'C2F8', 'C2G5', 'C2H0',
  'C2H4', 'C2H9', 'C2I0', 'C2I5', 'C2I8', 'C2J6', 'C2K2', 'C2K6', 'C2L0', 'C2L2',
  'C2L4', 'C2L5', 'C2M2', 'C2M4', 'C2M5', 'C2N0', 'C2N1', 'C2N4', 'C2P1', 'C2P4',
  'C2Q2', 'C2Q3', 'C2Q4', 'C2R3', 'C2R4', 'C2R5', 'C2R7', 'C2R9', 'C2S1', 'C2S3',
  'C2U1', 'C2U9', 'C2V3', 'C2W0', 'C2X0', 'C2X3', 'C2Y5', 'C2Z2', 'C2Z8', 'C300',
  'C301', 'C302', 'C305', 'C306', 'C308', 'C309', 'C311', 'C312', 'C317', 'C318',
  'C319', 'C321', 'C323', 'C324', 'C330', 'C333', 'C336', 'C337', 'C339', 'C342',
  'C343', 'C346', 'C350', 'C355', 'C365', 'C367', 'C369', 'C370', 'C373', 'C376',
  'C381', 'C383', 'C385', 'C386', 'C388', 'C390', 'C392', 'C3A6', 'C3B5', 'C3B9',
  'C3C2', 'C3D0', 'C3D2', 'C3D3', 'C3D4', 'C3D9', 'C3E1', 'C3E2', 'C3E6', 'C3E7',
  'C3F4', 'C3G1', 'C3G8', 'C3G9', 'C3I1', 'C3I2', 'C3I3', 'C3I7', 'C3J0', 'C3J2',
  'C3J4', 'C3J8', 'C3K9', 'C3L2', 'C3L3', 'C3L4', 'C3M1', 'C3M4', 'C3N7', 'C3N8',
  'C3N9', 'C3P2', 'C3P3', 'C3P5', 'C3P8', 'C3Q7', 'C3Q8', 'C3Q9', 'C3S0', 'C3S6',
  'C3S7', 'C3T0', 'C3T1', 'C3T3', 'C3T5', 'C3U5', 'C3V2', 'C3V3', 'C3V4', 'C3V9',
  'C3W6', 'C3X5', 'C3X7', 'C3Y1', 'C3Y3', 'C3Y7', 'C3Y8', 'C3Z3', 'C414', 'C419',
  'C420', 'C422', 'C426', 'C428', 'C430', 'C437', 'C440', 'C444', 'C460', 'C464',
  'C472', 'C473', 'C474', 'C475', 'C485', 'C487', 'C496', 'C4A0', 'C4A2', 'C4B4',
  'C4C7', 'C4D5', 'C4F2', 'C4F6', 'C4I1', 'C4K1', 'C4K8', 'C4K9', 'C4L4', 'C4L7',
  'C4L9', 'C4N3', 'C4Q5', 'C4R2', 'C4R3', 'C4S6', 'C4T0', 'C4T3', 'C4T9', 'C4U2',
  'C4U8', 'C4W0', 'C4W2', 'C4W6', 'C4X1', 'C4X2', 'C4X6', 'C4X7', 'C4Y5', 'C4Z3',
  'C4Z4', 'C4Z5', 'C502', 'C508', 'C514', 'C524', 'C525', 'C527', 'C543', 'C561',
  'C564', 'C592', 'C593', 'C5A9', 'C5B2', 'C5E0', 'C5E8', 'C5I4', 'C5J1', 'C5J3',
  'C5J5', 'C5J6', 'C5J7', 'C5K7', 'C5L8', 'C5N1', 'C5P6', 'C5U4', 'C5U9', 'C5W1',
  'C5W2', 'C5X4', 'C5Z0', 'C5Z1', 'C5Z9', 'C622', 'C662', 'C683', 'C688',
]);

// ==================== TOGGLE STATE ====================
let loungeFilterActive = sessionStorage.getItem('execLoungeToggleActive') === 'true';
let showAllRatesActive = sessionStorage.getItem('execShowAllRatesActive') === 'true';
let detectedLoyaltyTier = sessionStorage.getItem('execLoyaltyTier') || null;
let loyaltyDetectionDone = detectedLoyaltyTier !== null;

// ==================== STYLES ====================
function injectStyles() {
  if (document.getElementById('exec-lounge-styles')) return;
  const style = document.createElement('style');
  style.id = 'exec-lounge-styles';
  style.textContent = `
    .exec-lounge-highlighted {
      border: 4px solid #e63946 !important;
      border-radius: 6px !important;
      position: relative !important;
    }
    .exec-lounge-badge {
      position: absolute;
      top: 4px;
      right: 4px;
      background: #e63946;
      color: #ffffff;
      font-size: 11px;
      font-weight: 700;
      padding: 3px 8px;
      border-radius: 4px;
      z-index: 10;
      pointer-events: none;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      white-space: nowrap;
      box-shadow: 0 1px 3px rgba(0,0,0,0.3);
      min-width: 126px;
      text-align: center;
      box-sizing: border-box;
    }
    .free-breakfast-badge {
      position: absolute;
      top: 22px;
      right: 4px;
      background: #0e8a16;
      color: #ffffff;
      font-size: 11px;
      font-weight: 700;
      padding: 3px 8px;
      border-radius: 4px;
      z-index: 10;
      pointer-events: none;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      white-space: nowrap;
      box-shadow: 0 1px 3px rgba(0,0,0,0.3);
      min-width: 126px;
      text-align: center;
      box-sizing: border-box;
    }
    .free-breakfast-only {
      position: relative !important;
    }
    .free-breakfast-only .free-breakfast-badge {
      top: 4px;
    }
    .exec-lounge-hidden {
      display: none !important;
    }
    #exec-lounge-toggle-btn {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 6px 14px;
      border: 2px solid #e63946;
      border-radius: 20px;
      font-size: 13px;
      font-weight: 600;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      cursor: pointer;
      transition: all 0.2s ease;
      margin-left: 12px;
      vertical-align: middle;
      line-height: 1.4;
    }
    #exec-lounge-toggle-btn.active {
      background: #e63946;
      color: #ffffff;
    }
    #exec-lounge-toggle-btn:not(.active) {
      background: transparent;
      color: #e63946;
    }
    #exec-lounge-toggle-btn:hover {
      opacity: 0.85;
    }
    #exec-lounge-counter {
      font-size: 12px;
      color: #888;
      margin-left: 8px;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      vertical-align: middle;
    }
    p.offer-price.exec-tax-styled {
      font-size: 13px !important;
      font-weight: 500 !important;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      color: #1a1a2e !important;
      line-height: 1.5 !important;
      letter-spacing: 0.01em;
      text-align: right !important;
      padding-right: 10px !important;
    }
    .exec-tax-total {
      color: #e63946;
      font-weight: 700;
      font-size: 1.15em;
    }
    .exec-tax-per-night {
      color: #555;
      font-size: 0.92em;
      font-weight: 400;
    }
    .exec-base-price {
      font-weight: 600;
      display: block;
      text-align: right;
      padding-right: 10px;
    }
    #show-all-rates-btn {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 6px 14px;
      border: 2px solid #1a73e8;
      border-radius: 20px;
      font-size: 13px;
      font-weight: 600;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      cursor: pointer;
      transition: all 0.2s ease;
      line-height: 1.4;
    }
    #show-all-rates-btn.active {
      background: #1a73e8;
      color: #ffffff;
    }
    #show-all-rates-btn:not(.active) {
      background: transparent;
      color: #1a73e8;
    }
    #show-all-rates-btn:hover {
      opacity: 0.85;
    }
    .ext-all-rates-panel {
      padding: 8px 12px;
      margin: 4px 0 8px 0;
      border-top: 1px solid #e0e0e0;
    }
    .ext-rate-card {
      display: grid;
      grid-template-columns: 1.5fr 1fr 1fr 1fr;
      align-items: center;
      gap: 8px;
      padding: 6px 8px;
      border: 1px solid #e8e8e8;
      border-radius: 6px;
      margin-bottom: 4px;
      background: #fafafa;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      font-size: 12px;
    }
    .ext-rate-card:hover {
      background: #f0f4ff;
    }
    .ext-rate-name {
      font-weight: 600;
      color: #1a1a2e;
    }
    .ext-rate-type-badge {
      display: inline-block;
      background: #ff9800;
      color: #fff;
      font-size: 9px;
      font-weight: 700;
      padding: 1px 5px;
      border-radius: 3px;
      margin-left: 4px;
      vertical-align: middle;
    }
    .ext-rate-meal {
      color: #0e8a16;
      font-size: 11px;
    }
    .ext-rate-policy {
      font-size: 11px;
    }
    .ext-rate-policy.free-cancel {
      color: #0e8a16;
    }
    .ext-rate-policy.non-refundable {
      color: #d32f2f;
    }
    .ext-rate-price {
      text-align: right;
    }
    .ext-rate-member-price {
      font-weight: 700;
      color: #e63946;
      font-size: 13px;
    }
    .ext-rate-public-price {
      text-decoration: line-through;
      color: #999;
      font-size: 11px;
      margin-left: 4px;
    }
    .ext-rate-savings {
      color: #0e8a16;
      font-size: 10px;
    }
    .ext-rate-tax {
      color: #888;
      font-size: 10px;
    }
    .ext-rate-total-line {
      font-size: 12px;
      color: #1a1a2e;
      font-weight: 500;
    }
    .ext-rate-per-night {
      color: #555;
      font-size: 10px;
      font-weight: 400;
    }
    .ext-rate-tax-breakdown {
      font-size: 10px;
      color: #666;
      font-weight: 400;
    }
    .exec-detail-tax {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      font-size: 13px;
      font-weight: 500;
      color: #1a1a2e;
      line-height: 1.5;
      padding: 4px 12px;
      text-align: right;
    }
    .exec-detail-tax .exec-tax-total {
      color: #e63946;
      font-weight: 700;
      font-size: 1.15em;
    }
    .exec-detail-tax .exec-tax-per-night {
      color: #555;
      font-size: 0.92em;
      font-weight: 400;
    }
    .exec-detail-tax-breakdown {
      font-size: 11px;
      color: #666;
      font-weight: 400;
    }
    .exec-detail-badges {
      display: flex;
      gap: 8px;
      padding: 8px 16px;
      flex-wrap: wrap;
    }
    .exec-detail-badge {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      padding: 5px 14px;
      border-radius: 4px;
      font-size: 13px;
      font-weight: 700;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      color: #ffffff;
      box-shadow: 0 1px 3px rgba(0,0,0,0.3);
      white-space: nowrap;
    }
    .exec-detail-badge--lounge {
      background: #e63946;
    }
    .exec-detail-badge--breakfast {
      background: #0e8a16;
    }
    .exec-loyalty-badge {
      display: inline-flex;
      align-items: center;
      padding: 3px 10px;
      border-radius: 20px;
      font-size: 12px;
      font-weight: 600;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      white-space: nowrap;
      margin-left: 8px;
      vertical-align: middle;
    }
    .exec-loyalty-badge--classic {
      background: #f0f0f0;
      color: #666;
    }
    .exec-loyalty-badge--silver {
      background: #c0c0c0;
      color: #333;
    }
    .exec-loyalty-badge--gold {
      background: #f5c518;
      color: #333;
    }
    .exec-loyalty-badge--platinum {
      background: #e8e8e8;
      color: #333;
    }
    .exec-loyalty-badge--diamond {
      background: #1a1a2e;
      color: #fff;
    }
    .exec-loyalty-badge--limitless {
      background: linear-gradient(135deg, #1a1a2e, #6b21a8);
      color: #fff;
    }
    .exec-loyalty-badge.exec-detail-badge {
      margin-left: 0;
    }
    .exec-upgrade-indicator {
      display: flex;
      align-items: center;
      gap: 6px;
      background: #f3e8ff;
      border: 1px solid #d4b8ff;
      border-radius: 4px;
      padding: 4px 10px;
      margin-top: 6px;
      font-size: 11px;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      color: #6b21a8;
    }
    .exec-upgrade-arrow {
      font-size: 14px;
      color: #6b21a8;
    }
    .exec-benefits-box {
      background: rgba(230, 57, 70, 0.08);
      border: 2px solid #e63946;
      border-radius: 8px;
      padding: 14px 18px;
      margin: 12px 0;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
    }
    .exec-benefits-header {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 10px;
    }
    .exec-benefits-tier {
      display: inline-flex;
      align-items: center;
      padding: 4px 12px;
      border-radius: 20px;
      font-size: 14px;
      font-weight: 700;
      color: #fff;
      background: #e63946;
    }
    .exec-benefits-title {
      font-size: 13px;
      font-weight: 600;
      color: #1a1a2e;
    }
    .exec-benefits-list {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
    }
    .exec-benefit-item {
      display: inline-flex;
      align-items: center;
      gap: 5px;
      padding: 5px 12px;
      border-radius: 6px;
      font-size: 12px;
      font-weight: 600;
      background: rgba(230, 57, 70, 0.12);
      color: #b71c28;
    }
    .exec-benefit-item--inactive {
      background: #f0f0f0;
      color: #999;
    }
    .exec-benefit-check {
      font-size: 13px;
    }
  `;
  document.head.appendChild(style);
}

// ==================== HIGHLIGHT CARDS ====================
function highlightCard(card) {
  const hotelId = card.getAttribute('data-hotel-id');
  if (!EXECUTIVE_LOUNGE_HOTEL_IDS.has(hotelId)) return;
  if (card.getAttribute('data-exec-lounge-highlighted') === 'true') return;
  card.setAttribute('data-exec-lounge-highlighted', 'true');
  card.classList.add('exec-lounge-highlighted');
  const badge = document.createElement('div');
  badge.className = 'exec-lounge-badge';
  badge.textContent = 'Executive Lounge \u2713';
  card.appendChild(badge);
  // Parse price data for this card
  const priceData = parsePriceData(card);
  if (priceData) console.log('[ExecLounge] Price data:', hotelId, priceData);
}

function addBreakfastBadge(card) {
  const hotelId = card.getAttribute('data-hotel-id');
  if (!FREE_BREAKFAST_HOTEL_IDS.has(hotelId)) return;
  if (card.getAttribute('data-breakfast-badge') === 'true') return;
  card.setAttribute('data-breakfast-badge', 'true');
  // If breakfast-only (no lounge), add position:relative and place badge at top
  if (!EXECUTIVE_LOUNGE_HOTEL_IDS.has(hotelId)) {
    card.classList.add('free-breakfast-only');
  }
  const badge = document.createElement('div');
  badge.className = 'free-breakfast-badge';
  badge.textContent = 'Free Breakfast \u2713';
  card.appendChild(badge);
}

function highlightCards(root) {
  const cards = (root || document).querySelectorAll('div.result-list-item[data-hotel-id]');
  cards.forEach(card => {
    highlightCard(card);
    addBreakfastBadge(card);
    addTaxInclusivePrice(card);
  });
}

// ==================== HOTEL DETAIL PAGE BADGES ====================
function getHotelIdFromUrl() {
  const match = location.pathname.match(/\/hotel\/([A-Za-z0-9]+)/i);
  return match ? match[1] : null;
}

function injectDetailPageBadges() {
  if (!isHotelDetailPage()) return;
  if (document.getElementById('exec-detail-badges')) return;

  const hotelId = getHotelIdFromUrl();
  if (!hotelId) return;

  const hasLounge = EXECUTIVE_LOUNGE_HOTEL_IDS.has(hotelId);
  const hasBreakfast = FREE_BREAKFAST_HOTEL_IDS.has(hotelId);
  if (!hasLounge && !hasBreakfast) return;

  const wrapper = document.createElement('div');
  wrapper.id = 'exec-detail-badges';
  wrapper.className = 'exec-detail-badges';

  if (hasLounge) {
    const badge = document.createElement('span');
    badge.className = 'exec-detail-badge exec-detail-badge--lounge';
    badge.textContent = 'Executive Lounge \u2713';
    wrapper.appendChild(badge);
  }
  if (hasBreakfast) {
    const badge = document.createElement('span');
    badge.className = 'exec-detail-badge exec-detail-badge--breakfast';
    badge.textContent = 'Free Breakfast \u2713';
    wrapper.appendChild(badge);
  }

  // Insert near the top of the page — try hotel name/header selectors
  const header = document.querySelector('[class*="hotel-name"]')
    || document.querySelector('[class*="hotel-header"]')
    || document.querySelector('[class*="hotel-title"]')
    || document.querySelector('[class*="property-name"]')
    || document.querySelector('h1');

  if (header) {
    header.insertAdjacentElement('afterend', wrapper);
  } else {
    // Fallback: insert before the first room card or at top of main content
    const roomsContainer = findRoomsContainer();
    if (roomsContainer && roomsContainer.parentNode) {
      roomsContainer.parentNode.insertBefore(wrapper, roomsContainer);
    }
  }
  // Append loyalty badge if tier is detected
  if (detectedLoyaltyTier) {
    const tierLower = detectedLoyaltyTier.toLowerCase();
    const loyaltyBadge = document.createElement('span');
    loyaltyBadge.id = 'exec-loyalty-badge';
    loyaltyBadge.className = `exec-detail-badge exec-loyalty-badge exec-loyalty-badge--${tierLower}`;
    loyaltyBadge.textContent = 'ALL - ' + detectedLoyaltyTier.charAt(0) + detectedLoyaltyTier.slice(1).toLowerCase();
    wrapper.appendChild(loyaltyBadge);
  }

  console.log('[ExecLounge] Detail page badges injected for hotel', hotelId,
    hasLounge ? '+Lounge' : '', hasBreakfast ? '+Breakfast' : '');
}

// ==================== PRICE HELPERS ====================
/**
 * Parse a localized number string into a float.
 * Handles US (1,350.00) and European (1.350,00) formats.
 */
function parseLocalizedNumber(str) {
  str = str.replace(/\s/g, '');
  if (str.includes(',') && str.includes('.')) {
    // Both separators: last one is the decimal
    if (str.lastIndexOf(',') > str.lastIndexOf('.')) {
      // European: 1.350,00
      return parseFloat(str.replace(/\./g, '').replace(',', '.'));
    }
    // US: 1,350.00
    return parseFloat(str.replace(/,/g, ''));
  }
  if (str.includes(',')) {
    // Single comma: decimal if followed by exactly 2 digits at end, else thousands
    if (/,\d{2}$/.test(str) && (str.match(/,/g) || []).length === 1) {
      return parseFloat(str.replace(',', '.'));
    }
    return parseFloat(str.replace(/,/g, ''));
  }
  return parseFloat(str);
}

/**
 * Extract currency symbol and numeric amount from a price string.
 * Supports prefix ($45, A$1,350) and suffix (1.350,00 €) currencies.
 */
function parseCurrencyAmount(text) {
  // Try prefix currency: $45, A$1,350, HK$200, €67,50
  let match = text.match(/([^\d\s.,]+)\s*([\d.,]+)/);
  if (match) {
    const amount = parseLocalizedNumber(match[2]);
    if (!isNaN(amount)) return { currency: match[1].trim(), amount };
  }
  // Try suffix currency: 1.350,00 €
  match = text.match(/([\d.,]+)\s*([^\d\s.,]+)/);
  if (match) {
    const amount = parseLocalizedNumber(match[1]);
    if (!isNaN(amount)) return { currency: match[2].trim(), amount };
  }
  return null;
}

// ==================== PRICE DATA PARSING ====================
function parsePriceData(card) {
  try {
    // Extract base price and currency from span.offer-price__amount
    const priceEl = card.querySelector('span.offer-price__amount');
    if (!priceEl) return null;
    const priceText = priceEl.textContent.trim();
    const priceResult = parseCurrencyAmount(priceText);
    if (!priceResult) return null;

    // Extract tax from span.stay-details__formatted-tax-type
    const taxEl = card.querySelector('span.stay-details__formatted-tax-type');
    if (!taxEl) return null;
    const taxText = taxEl.textContent.trim();
    const taxResult = parseCurrencyAmount(taxText);
    if (!taxResult) return null;

    // Extract nights from span.pricing-type-label
    const nightsEl = card.querySelector('span.pricing-type-label');
    if (!nightsEl) return null;
    const nightsText = nightsEl.textContent.trim();
    const nightsMatch = nightsText.match(/(\d+)\s*night/i);
    if (!nightsMatch) return null;
    const nights = parseInt(nightsMatch[1], 10);
    if (isNaN(nights) || nights < 1) return null;

    return {
      basePrice: priceResult.amount,
      tax: taxResult.amount,
      nights,
      currency: priceResult.currency,
      raw: { priceText, taxText, nightsText }
    };
  } catch (e) {
    return null;
  }
}


// ==================== TAX-INCLUSIVE PRICE ====================
function formatPrice(amount) {
  return amount % 1 === 0 ? String(amount) : amount.toFixed(2);
}

function addTaxInclusivePrice(card) {
  if (card.getAttribute('data-exec-tax-processed') === 'true') return;
  const data = parsePriceData(card);
  if (!data) {
    const hotelId = card.getAttribute('data-hotel-id') || 'unknown';
    console.debug('[ExecLounge] No tax data for hotel', hotelId, ', skipping');
    return;
  }

  const total = data.basePrice + data.tax;
  const perNight = total / data.nights;
  const basePriceStr = formatPrice(data.basePrice);
  const totalStr = formatPrice(total);
  const perNightStr = formatPrice(Math.round(perNight));

  const offerPrice = card.querySelector('p.offer-price');
  if (!offerPrice) return;

  offerPrice.classList.add('exec-tax-styled');
  if (data.nights > 1) {
    offerPrice.innerHTML = `Total: <span class="exec-tax-total">${data.currency}${totalStr}</span> w/ Tax <span class="exec-tax-per-night">(${data.currency}${perNightStr}/night)</span>`;
  } else {
    offerPrice.innerHTML = `Total: <span class="exec-tax-total">${data.currency}${totalStr}</span> w/ Tax`;
  }

  // Replace tax details with "From $XX + Taxes $YY"
  const taxEl = card.querySelector('span.stay-details__formatted-tax-type');
  if (taxEl && !card.querySelector('.exec-base-price')) {
    const taxStr = formatPrice(data.tax);
    const baseSpan = document.createElement('span');
    baseSpan.className = 'exec-base-price';
    baseSpan.textContent = `From ${data.currency}${basePriceStr} + Taxes ${data.currency}${taxStr}`;
    taxEl.parentNode.replaceChild(baseSpan, taxEl);
  }

  card.setAttribute('data-exec-tax-processed', 'true');
}

// Helper: get number of nights from URL (tries nights param, then dateIn/dateOut)
function getNightsFromUrl() {
  const params = new URLSearchParams(location.search);
  const n = parseInt(params.get('nights'), 10);
  if (n > 0) return n;
  const dateIn = params.get('dateIn');
  const dateOut = params.get('dateOut');
  if (dateIn && dateOut) {
    const diff = (new Date(dateOut) - new Date(dateIn)) / (1000 * 60 * 60 * 24);
    if (diff > 0) return Math.round(diff);
  }
  return 1;
}

// ==================== DETAIL PAGE TAX-INCLUSIVE PRICE ====================
// Helper: detect currency format (prefix vs suffix) and build formatter
function buildCurrencyFormatter(formattedAmount) {
  const prefixMatch = formattedAmount.match(/^([^\d.,\s]+)\s*/);
  const suffixMatch = formattedAmount.match(/\s*([^\d.,\s]+)$/);
  if (prefixMatch && !suffixMatch) {
    return (amount) => prefixMatch[1] + formatPrice(amount);
  }
  if (suffixMatch && !prefixMatch) {
    return (amount) => formatPrice(amount) + ' ' + suffixMatch[1];
  }
  // Default to prefix
  const cur = (prefixMatch && prefixMatch[1]) || (suffixMatch && suffixMatch[1]) || '$';
  return (amount) => cur + formatPrice(amount);
}

// Compute tax-inclusive data from an Apollo cache offer
function computeTaxData(offer, nights) {
  const mainPrice = offer.pricing && offer.pricing.main;
  if (!mainPrice || !mainPrice.amount) return null;

  const baseAmount = mainPrice.amount;
  const formattedBase = mainPrice.formattedAmount || '';
  const taxText = (offer.pricing && offer.pricing.formattedTaxType) || '';
  const taxParsed = parseCurrencyAmount(taxText);
  if (!taxParsed) return null;

  const taxAmount = taxParsed.amount;
  const total = baseAmount + taxAmount;
  const perNight = Math.round(total / nights);
  const fmt = buildCurrencyFormatter(formattedBase);

  return {
    total, baseAmount, taxAmount, perNight, nights, fmt,
    fmtTotal: fmt(total),
    fmtBase: fmt(baseAmount),
    fmtTax: fmt(taxAmount),
    fmtPerNight: fmt(perNight),
  };
}

async function addTaxToDetailPageRooms() {
  if (!isHotelDetailPage()) return;
  const roomSelector = findRoomsSelector();
  const rooms = document.querySelectorAll(roomSelector);
  if (rooms.length === 0) return;

  const needsProcessing = [...rooms].some(r => !r.querySelector('.exec-detail-tax'));
  if (!needsProcessing) return;

  const cache = await extractApolloCacheViaPageScript();
  if (!cache) return;

  const nights = getNightsFromUrl();

  rooms.forEach(roomEl => {
    if (roomEl.querySelector('.exec-detail-tax')) return;
    if (roomEl.offsetHeight === 0) return;

    const offerClass = [...roomEl.classList].find(c => c.startsWith('hotel-offer-'));
    if (!offerClass) return;
    const offerId = offerClass.replace('hotel-offer-', '');
    const offer = cache['BestOfferInfo:' + offerId];
    if (!offer || !offer.pricing) return;

    const tax = computeTaxData(offer, nights);
    if (!tax) return;

    // Hide original price and tax elements to avoid duplication
    roomEl.querySelectorAll('[class*="price"], [class*="tax"], [class*="stay-details"]').forEach(el => {
      if (!el.classList.contains('exec-detail-tax') && !el.closest('.ext-all-rates-panel')) {
        el.style.display = 'none';
      }
    });

    // Build element matching search page format:
    // Total: $275 w/ Tax ($92/night)
    // From $242 + Taxes $33
    const taxDiv = document.createElement('div');
    taxDiv.className = 'exec-detail-tax';

    let line1 = `Total: <span class="exec-tax-total">${tax.fmtTotal}</span> w/ Tax`;
    if (nights > 1) {
      line1 += ` <span class="exec-tax-per-night">(${tax.fmtPerNight}/night)</span>`;
    }
    const line2 = `From ${tax.fmtBase} + Taxes ${tax.fmtTax}`;
    taxDiv.innerHTML = line1 + `<br><span class="exec-detail-tax-breakdown">${line2}</span>`;

    // Insert into the room card
    const topInfos = roomEl.querySelector('[class*="top-infos"]')
      || roomEl.querySelector('[class*="accommodation__top"]');
    if (topInfos) {
      topInfos.insertAdjacentElement('afterend', taxDiv);
    } else {
      roomEl.appendChild(taxDiv);
    }
  });
}

// ==================== SHOW ALL RATES ====================
function extractApolloCacheViaPageScript() {
  return new Promise((resolve) => {
    const timeout = setTimeout(() => {
      document.removeEventListener('exec-response-cache', handler);
      console.warn('[ExecLounge] Cache request timed out');
      resolve(null);
    }, 8000);
    function handler(e) {
      clearTimeout(timeout);
      document.removeEventListener('exec-response-cache', handler);
      try {
        const data = JSON.parse(e.detail);
        if (data.error) {
          console.warn('[ExecLounge] Bridge error:', data.error, data.diag || '');
          resolve(null);
        } else {
          resolve(data.cache || null);
        }
      } catch {
        resolve(null);
      }
    }
    document.addEventListener('exec-response-cache', handler);
    document.dispatchEvent(new CustomEvent('exec-request-cache'));
  });
}

// ==================== LOYALTY DETECTION ====================
function extractLoyaltyViaPageScript() {
  return new Promise((resolve) => {
    const timeout = setTimeout(() => {
      document.removeEventListener('exec-response-loyalty', handler);
      resolve(null);
    }, 8000);
    function handler(e) {
      clearTimeout(timeout);
      document.removeEventListener('exec-response-loyalty', handler);
      try { resolve(JSON.parse(e.detail)); } catch { resolve(null); }
    }
    document.addEventListener('exec-response-loyalty', handler);
    document.dispatchEvent(new CustomEvent('exec-request-loyalty'));
  });
}

async function detectAndCacheLoyaltyTier() {
  if (loyaltyDetectionDone) return detectedLoyaltyTier;
  const result = await extractLoyaltyViaPageScript();
  loyaltyDetectionDone = true;
  if (result && result.tierCode) {
    detectedLoyaltyTier = result.tierCode;
    sessionStorage.setItem('execLoyaltyTier', result.tierCode);
  } else {
    detectedLoyaltyTier = '';
    sessionStorage.setItem('execLoyaltyTier', '');
  }
  injectLoyaltyBadge();
  injectBenefitsBox();
  if (isHotelDetailPage()) markUpgradeEligibleRooms();
  return detectedLoyaltyTier;
}

// ==================== LOYALTY BADGE ====================
function injectLoyaltyBadge() {
  if (!detectedLoyaltyTier) return;
  // Don't duplicate
  if (document.getElementById('exec-loyalty-badge')) return;

  const tierLower = detectedLoyaltyTier.toLowerCase();
  const badge = document.createElement('span');
  badge.id = 'exec-loyalty-badge';
  badge.className = `exec-loyalty-badge exec-loyalty-badge--${tierLower}`;
  badge.textContent = 'ALL - ' + detectedLoyaltyTier.charAt(0) + detectedLoyaltyTier.slice(1).toLowerCase();

  if (isHotelDetailPage()) {
    // On detail pages: add as a detail badge
    let detailBadges = document.getElementById('exec-detail-badges');
    if (!detailBadges) {
      // Create the wrapper if injectDetailPageBadges didn't (no lounge/breakfast)
      detailBadges = document.createElement('div');
      detailBadges.id = 'exec-detail-badges';
      detailBadges.className = 'exec-detail-badges';
      const header = document.querySelector('[class*="hotel-name"]')
        || document.querySelector('[class*="hotel-header"]')
        || document.querySelector('[class*="hotel-title"]')
        || document.querySelector('[class*="property-name"]')
        || document.querySelector('h1');
      if (header) {
        header.insertAdjacentElement('afterend', detailBadges);
      } else {
        const roomsContainer = findRoomsContainer();
        if (roomsContainer && roomsContainer.parentNode) {
          roomsContainer.parentNode.insertBefore(detailBadges, roomsContainer);
        } else {
          return; // No anchor found, skip
        }
      }
    }
    badge.classList.add('exec-detail-badge');
    detailBadges.appendChild(badge);
    return;
  }
  // On search pages: append to toggle wrapper
  const wrapper = document.getElementById('exec-lounge-toggle-wrapper');
  if (wrapper) {
    wrapper.appendChild(badge);
  }
}

// ==================== UPGRADE ELIGIBILITY ====================
const ROOM_CATEGORY_KEYWORDS = [
  { rank: 1, keywords: ['standard', 'classic', 'starter', 'economy'] },
  { rank: 2, keywords: ['superior', 'comfort', 'privilege'] },
  { rank: 3, keywords: ['deluxe', 'premium', 'executive room', 'club'] },
  { rank: 4, keywords: ['junior suite', 'studio suite'] },
  { rank: 5, keywords: ['suite', 'prestige', 'residence', 'presidential', 'royal'] },
];

function getRoomCategoryRank(roomName) {
  if (!roomName) return 0;
  const lower = roomName.toLowerCase();
  // Check higher ranks first to avoid "suite" matching before "junior suite"
  for (let i = ROOM_CATEGORY_KEYWORDS.length - 1; i >= 0; i--) {
    const cat = ROOM_CATEGORY_KEYWORDS[i];
    for (const kw of cat.keywords) {
      if (lower.includes(kw)) return cat.rank;
    }
  }
  return 0;
}

function markUpgradeEligibleRooms() {
  const UPGRADE_TIERS = ['PLATINUM', 'DIAMOND', 'LIMITLESS'];
  if (!detectedLoyaltyTier || !UPGRADE_TIERS.includes(detectedLoyaltyTier.toUpperCase())) return;

  // Remove existing indicators
  document.querySelectorAll('.exec-upgrade-indicator').forEach(el => el.remove());

  const roomSelector = findRoomsSelector();
  const rooms = document.querySelectorAll(roomSelector);
  if (rooms.length < 2) return;

  // Build ranked list
  const roomData = [...rooms].map(el => {
    const nameEl = el.querySelector('[class*="accommodation__title"], [class*="room-name"], [class*="offer-name"], h2, h3');
    const name = nameEl ? nameEl.textContent.trim() : '';
    return { el, name, rank: getRoomCategoryRank(name) };
  });

  const maxRank = Math.max(...roomData.map(r => r.rank));
  if (maxRank <= 0) return;

  for (const room of roomData) {
    if (room.rank >= maxRank || room.rank === 0) continue;
    // Find next higher room
    const nextUp = roomData
      .filter(r => r.rank > room.rank && r.name)
      .sort((a, b) => a.rank - b.rank)[0];
    if (!nextUp) continue;

    const indicator = document.createElement('div');
    indicator.className = 'exec-upgrade-indicator';
    indicator.innerHTML = '<span class="exec-upgrade-arrow">\u2B06</span> Upgrade eligible to ' +
      nextUp.name;
    room.el.appendChild(indicator);
  }
}

// ==================== BENEFITS BOX ====================
function injectBenefitsBox() {
  if (document.getElementById('exec-benefits-box')) return;

  const onDetailPage = isHotelDetailPage();
  const box = document.createElement('div');
  box.id = 'exec-benefits-box';
  box.className = 'exec-benefits-box';

  if (!detectedLoyaltyTier) {
    // Not logged in — show login prompt
    const header = document.createElement('div');
    header.className = 'exec-benefits-header';
    const title = document.createElement('span');
    title.className = 'exec-benefits-title';
    title.textContent = 'Log in to check your status and benefits';
    header.appendChild(title);
    box.appendChild(header);
  } else {
    const UPGRADE_TIERS = ['PLATINUM', 'DIAMOND', 'LIMITLESS'];
    const hasUpgrade = UPGRADE_TIERS.includes(detectedLoyaltyTier.toUpperCase());
    const tierDisplay = detectedLoyaltyTier.charAt(0) + detectedLoyaltyTier.slice(1).toLowerCase();

    // Header
    const header = document.createElement('div');
    header.className = 'exec-benefits-header';
    const tierBadge = document.createElement('span');
    tierBadge.className = 'exec-benefits-tier';
    tierBadge.textContent = 'ALL - ' + tierDisplay;
    header.appendChild(tierBadge);
    const title = document.createElement('span');
    title.className = 'exec-benefits-title';
    title.textContent = onDetailPage ? 'Eligible Benefits' : 'Your Benefits';
    header.appendChild(title);
    box.appendChild(header);

    // Benefits list
    const list = document.createElement('div');
    list.className = 'exec-benefits-list';

    let benefits;
    if (onDetailPage) {
      // Hotel-specific: check if this hotel has lounge/breakfast
      const hotelId = getHotelIdFromUrl();
      const hasLounge = hotelId && EXECUTIVE_LOUNGE_HOTEL_IDS.has(hotelId);
      const hasBreakfast = hotelId && FREE_BREAKFAST_HOTEL_IDS.has(hotelId);
      benefits = [
        { label: 'Executive Lounge', active: hasLounge },
        { label: 'Free Breakfast', active: hasBreakfast },
        { label: 'Room Upgrade', active: hasUpgrade },
      ];
    } else {
      // Search page: show general tier benefits
      benefits = [
        { label: 'Executive Lounge', active: hasUpgrade },
        { label: 'Free Breakfast', active: hasUpgrade },
        { label: 'Room Upgrade', active: hasUpgrade },
      ];
    }

    benefits.forEach(function(b) {
      const item = document.createElement('span');
      item.className = 'exec-benefit-item' + (b.active ? '' : ' exec-benefit-item--inactive');
      const check = document.createElement('span');
      check.className = 'exec-benefit-check';
      check.textContent = b.active ? '\u2713' : '\u2717';
      item.appendChild(check);
      item.appendChild(document.createTextNode(' ' + b.label));
      list.appendChild(item);
    });

    box.appendChild(list);
  }

  // Detail page: insert above the awards toggle
  if (onDetailPage) {
    const awardsModule = document.querySelector('[data-testid="conversational-module"]');
    if (awardsModule && awardsModule.parentNode) {
      awardsModule.parentNode.insertBefore(box, awardsModule);
      console.log('[ExecLounge] Benefits box injected above awards toggle');
      return;
    }
    const detailBadges = document.getElementById('exec-detail-badges');
    if (detailBadges) {
      detailBadges.insertAdjacentElement('afterend', box);
      return;
    }
    const headerEl = document.querySelector('[class*="hotel-name"]')
      || document.querySelector('[class*="hotel-header"]')
      || document.querySelector('h1');
    if (headerEl) {
      headerEl.insertAdjacentElement('afterend', box);
      return;
    }
  }

  // Search page: insert after toggle wrapper
  const toggleWrapper = document.getElementById('exec-lounge-toggle-wrapper');
  if (toggleWrapper) {
    toggleWrapper.insertAdjacentElement('afterend', box);
    console.log('[ExecLounge] Benefits box injected on search page');
    return;
  }
}

// Build a set of valid offer IDs that belong to the current page's hotel
function getPageOfferIds() {
  const ids = new Set();
  const roomSelector = findRoomsSelector();
  document.querySelectorAll(roomSelector).forEach(el => {
    const cls = [...el.classList].find(c => c.startsWith('hotel-offer-'));
    if (cls) ids.add(cls.replace('hotel-offer-', ''));
  });
  return ids;
}

function getOffersForRoom(roomEl, cache, validOfferIds) {
  const offerClass = [...roomEl.classList].find(c => c.startsWith('hotel-offer-'));
  if (!offerClass) {
    console.log('[ExecLounge] No hotel-offer- class on room. All classes:', [...roomEl.classList]);
    return [];
  }
  const bestOfferId = offerClass.replace('hotel-offer-', '');
  const bestOffer = cache['BestOfferInfo:' + bestOfferId];
  if (!bestOffer || !bestOffer.accommodation) {
    console.log('[ExecLounge] No BestOfferInfo:' + bestOfferId, 'in cache');
    return [];
  }

  // Use accommodation ref for precise matching (not just name which can collide across hotels)
  const accommRef = (bestOffer.accommodation && bestOffer.accommodation.__ref) || null;
  const accommCode = (bestOffer.accommodation && bestOffer.accommodation.code) || null;
  const roomName = bestOffer.accommodation.name;

  // Get hotel ID from URL for extra filtering
  const hotelIdMatch = location.pathname.match(/\/hotel\/([A-Za-z0-9]+)/i);
  const pageHotelId = hotelIdMatch ? hotelIdMatch[1] : null;

  console.log('[ExecLounge] Room match criteria — ref:', accommRef, 'code:', accommCode, 'name:', roomName, 'hotelId:', pageHotelId);

  // Log first offer structure for debugging
  console.log('[ExecLounge] Sample BestOfferInfo keys:', Object.keys(bestOffer));
  if (bestOffer.accommodation) console.log('[ExecLounge] accommodation keys:', Object.keys(bestOffer.accommodation));

  const allOffers = Object.entries(cache)
    .filter(([k, v]) => {
      if (!k.startsWith('BestOfferInfo:')) return false;
      if (!v.accommodation) return false;

      // Match by accommodation ref (most precise — unique per room type per hotel)
      if (accommRef && v.accommodation.__ref) {
        return v.accommodation.__ref === accommRef;
      }
      // Fallback: match by accommodation code
      if (accommCode && v.accommodation.code) {
        return v.accommodation.code === accommCode;
      }
      // Last resort: match by name BUT only if the offer ID is on this page
      // (prevents cross-hotel matches)
      if (v.accommodation.name === roomName) {
        const offerId = k.replace('BestOfferInfo:', '');
        // Accept if it's one of the page's offer IDs, OR if it shares a hotel ref
        if (validOfferIds && validOfferIds.has(offerId)) return true;
        // Check if this offer references the same hotel
        if (pageHotelId && v.hotel) {
          const offerHotelCode = (typeof v.hotel === 'string') ? v.hotel :
            (v.hotel.code || v.hotel.id || (v.hotel.__ref || '').replace(/.*:/, ''));
          if (offerHotelCode === pageHotelId) return true;
        }
        // If no hotel field, cautiously include it (same-name match)
        if (!v.hotel) return true;
        return false;
      }
      return false;
    })
    .map(([k, v]) => {
      const rateRef = (v.rate && v.rate.__ref) || '';
      const rateKey = rateRef;
      const rateInfo = cache[rateKey] || {};
      return Object.assign({}, v, { resolvedRate: rateInfo, cacheKey: k });
    });

  console.log('[ExecLounge] Found', allOffers.length, 'raw offers for', roomName);

  // Deduplicate by rate label + price
  const seen = new Set();
  const unique = allOffers.filter(o => {
    // Skip offers with no pricing (phantom/invalid)
    if (!o.pricing || !o.pricing.main || !o.pricing.main.amount) return false;
    const rateLabel = (o.resolvedRate && o.resolvedRate.label) || '';
    const amount = o.pricing.main.amount || 0;
    const key = rateLabel + '|' + amount;
    if (seen.has(key)) return false;
    seen.add(key);
    return true;
  });

  // Sort: ROOM type first, then by price ascending
  unique.sort((a, b) => {
    if (a.type !== b.type) return a.type === 'ROOM' ? -1 : 1;
    const aPrice = (a.pricing && a.pricing.main && a.pricing.main.amount) || 0;
    const bPrice = (b.pricing && b.pricing.main && b.pricing.main.amount) || 0;
    return aPrice - bPrice;
  });

  console.log('[ExecLounge] Returning', unique.length, 'unique offers for', roomName);
  return unique;
}

function buildRatePanel(offers, nights) {
  const panel = document.createElement('div');
  panel.className = 'ext-all-rates-panel';

  offers.forEach(offer => {
    const card = document.createElement('div');
    card.className = 'ext-rate-card';

    const rateName = (offer.resolvedRate && offer.resolvedRate.label) || 'Standard Rate';
    const memberPrice = (offer.pricing && offer.pricing.main && offer.pricing.main.formattedAmount) || '';
    const publicPrice = (offer.pricing && offer.pricing.alternative && offer.pricing.alternative.formattedAmount) || '';
    const deductions = (offer.pricing && offer.pricing.deduction) || [];
    const savings = deductions.length > 0 ? deductions[0].formattedAmount || '' : '';
    const simplifiedPolicies = (offer.pricing && offer.pricing.main && offer.pricing.main.simplifiedPolicies) || {};
    const cancellation = (simplifiedPolicies.cancellation && simplifiedPolicies.cancellation.label) || '';
    const cancellationCode = (simplifiedPolicies.cancellation && simplifiedPolicies.cancellation.code) || '';
    const mealPlan = (offer.mealPlan && offer.mealPlan.label) || '';
    const typeBadge = offer.type === 'PACKAGE' ? 'DEAL' : '';

    // Compute tax-inclusive total for this rate
    const tax = computeTaxData(offer, nights);

    // Column 1: Rate name + type badge
    const nameCol = document.createElement('div');
    nameCol.className = 'ext-rate-name';
    nameCol.textContent = rateName;
    if (typeBadge) {
      const badge = document.createElement('span');
      badge.className = 'ext-rate-type-badge';
      badge.textContent = typeBadge;
      nameCol.appendChild(badge);
    }

    // Column 2: Meal plan
    const mealCol = document.createElement('div');
    mealCol.className = 'ext-rate-meal';
    mealCol.textContent = mealPlan;

    // Column 3: Cancellation policy
    const policyCol = document.createElement('div');
    policyCol.className = 'ext-rate-policy';
    if (cancellationCode === 'FREE_CANCELLATION' || cancellation.toLowerCase().includes('free')) {
      policyCol.classList.add('free-cancel');
    } else if (cancellationCode === 'NON_REFUNDABLE' || cancellation.toLowerCase().includes('non')) {
      policyCol.classList.add('non-refundable');
    }
    policyCol.textContent = cancellation;

    // Column 4: Prices with tax-inclusive total
    const priceCol = document.createElement('div');
    priceCol.className = 'ext-rate-price';

    if (tax) {
      // Tax-inclusive total: "Total: $275 w/ Tax ($92/night)"
      const totalLine = document.createElement('div');
      totalLine.className = 'ext-rate-total-line';
      let totalHtml = `Total: <span class="ext-rate-member-price">${tax.fmtTotal}</span> w/ Tax`;
      if (nights > 1) {
        totalHtml += ` <span class="ext-rate-per-night">(${tax.fmtPerNight}/night)</span>`;
      }
      totalLine.innerHTML = totalHtml;
      priceCol.appendChild(totalLine);

      // "From $242 + Taxes $33"
      const breakdownLine = document.createElement('div');
      breakdownLine.className = 'ext-rate-tax-breakdown';
      breakdownLine.textContent = `From ${tax.fmtBase} + Taxes ${tax.fmtTax}`;
      priceCol.appendChild(breakdownLine);
    } else {
      // No tax data — just show member price
      if (memberPrice) {
        const memberSpan = document.createElement('span');
        memberSpan.className = 'ext-rate-member-price';
        memberSpan.textContent = memberPrice;
        priceCol.appendChild(memberSpan);
      }
    }

    if (publicPrice && publicPrice !== memberPrice) {
      const publicSpan = document.createElement('div');
      publicSpan.className = 'ext-rate-public-price';
      publicSpan.textContent = publicPrice;
      priceCol.appendChild(publicSpan);
    }
    if (savings) {
      const savingsDiv = document.createElement('div');
      savingsDiv.className = 'ext-rate-savings';
      savingsDiv.textContent = 'Save ' + savings;
      priceCol.appendChild(savingsDiv);
    }

    card.appendChild(nameCol);
    card.appendChild(mealCol);
    card.appendChild(policyCol);
    card.appendChild(priceCol);
    panel.appendChild(card);
  });

  return panel;
}

let showAllRatesRetryCount = 0;
const SHOW_ALL_RATES_MAX_RETRIES = 3;

async function injectAllRatePanels() {
  console.log('[ExecLounge] injectAllRatePanels() called');
  const cache = await extractApolloCacheViaPageScript();
  if (!cache) {
    console.warn('[ExecLounge] Apollo cache returned null, retry', showAllRatesRetryCount);
    if (showAllRatesRetryCount < SHOW_ALL_RATES_MAX_RETRIES) {
      showAllRatesRetryCount++;
      setTimeout(() => {
        if (showAllRatesActive) injectAllRatePanels();
      }, 500);
    } else {
      console.error('[ExecLounge] Apollo cache not available after retries');
    }
    return;
  }
  showAllRatesRetryCount = 0;

  // Debug: log ALL unique cache key prefixes to discover the naming pattern
  const cacheKeys = Object.keys(cache);
  const keyPrefixes = {};
  cacheKeys.forEach(k => {
    const prefix = k.split(':')[0] || k.split('.')[0] || k;
    keyPrefixes[prefix] = (keyPrefixes[prefix] || 0) + 1;
  });
  console.log('[ExecLounge] Cache has', cacheKeys.length, 'keys. Key prefixes:', keyPrefixes);
  console.log('[ExecLounge] Sample keys:', cacheKeys.slice(0, 50));

  // Look for keys containing pricing/offer/room-related terms
  const interestingKeys = cacheKeys.filter(k => /offer|room|accom|rate|price|pric|best|booking/i.test(k));
  console.log('[ExecLounge] Interesting keys:', interestingKeys.slice(0, 30));

  // If we find interesting keys, log a sample value
  if (interestingKeys.length > 0) {
    console.log('[ExecLounge] Sample value for', interestingKeys[0], ':', JSON.stringify(cache[interestingKeys[0]]).slice(0, 500));
  }

  // Also log the first few values to understand the structure
  const firstKeys = cacheKeys.slice(0, 5);
  firstKeys.forEach(k => {
    console.log('[ExecLounge] Key:', k, 'Value:', JSON.stringify(cache[k]).slice(0, 300));
  });

  // Collect valid offer IDs from the current page
  const validOfferIds = getPageOfferIds();
  console.log('[ExecLounge] Valid page offer IDs:', [...validOfferIds]);

  // Get nights from URL
  const nights = getNightsFromUrl();

  // Use the same selector that found the rooms container for the button
  const roomSelector = findRoomsSelector();
  const rooms = document.querySelectorAll(roomSelector);
  console.log('[ExecLounge] Found', rooms.length, 'rooms with selector:', roomSelector);

  rooms.forEach((roomEl, i) => {
    if (roomEl.querySelector('.ext-all-rates-panel')) return;
    if (roomEl.classList.contains('hotel-accommodation--selected')) return;
    if (roomEl.offsetHeight === 0) return;

    console.log('[ExecLounge] Room', i, 'classes:', [...roomEl.classList]);
    const offers = getOffersForRoom(roomEl, cache, validOfferIds);
    console.log('[ExecLounge] Room', i, 'offers found:', offers.length);
    if (offers.length === 0) return;

    const panel = buildRatePanel(offers, nights);
    // Try multiple insertion points
    const topInfos = roomEl.querySelector('.hotel-accommodation__top-infos')
      || roomEl.querySelector('[class*="top-infos"]')
      || roomEl.querySelector('[class*="room-info"]')
      || roomEl.querySelector('[class*="accommodation__top"]');
    if (topInfos) {
      topInfos.insertAdjacentElement('afterend', panel);
    } else {
      console.log('[ExecLounge] No top-infos found, appending to room. Children:',
        [...roomEl.children].map(c => c.className).slice(0, 5));
      roomEl.appendChild(panel);
    }
  });
}

function removeAllRatePanels() {
  document.querySelectorAll('.ext-all-rates-panel').forEach(el => el.remove());
}

function isHotelDetailPage() {
  return /\/hotel\/[A-Za-z0-9]+/i.test(location.pathname);
}

const ROOM_SELECTORS = [
  '.hotel-accommodation',
  '[class*="hotel-accommodation"]',
  '[class*="room-card"]',
  '[class*="accommodation"]',
  '[class*="room-list"]',
  '[class*="offer-list"]',
  '[class*="hotel-offer"]',
];

function findRoomsSelector() {
  for (const sel of ROOM_SELECTORS) {
    if (document.querySelector(sel)) return sel;
  }
  return '.hotel-accommodation';
}

function findRoomsContainer() {
  for (const sel of ROOM_SELECTORS) {
    const el = document.querySelector(sel);
    if (el) {
      console.log('[ExecLounge] Found rooms container with selector:', sel, el);
      return el;
    }
  }
  return null;
}

function injectShowAllRatesButton() {
  if (document.getElementById('show-all-rates-btn')) return;
  if (!isHotelDetailPage()) return;

  const roomsContainer = findRoomsContainer();
  if (!roomsContainer) {
    console.debug('[ExecLounge] No rooms container found yet. DOM classes on page:',
      [...new Set([...document.querySelectorAll('[class]')].flatMap(el => [...el.classList]).filter(c => /room|accom|offer|rate|hotel/i.test(c)))].slice(0, 30)
    );
    return;
  }

  const btn = document.createElement('button');
  btn.id = 'show-all-rates-btn';
  btn.type = 'button';
  btn.addEventListener('click', toggleShowAllRates);

  const wrapper = document.createElement('div');
  wrapper.id = 'show-all-rates-wrapper';
  wrapper.style.cssText = 'padding: 8px 16px; display: flex; align-items: center;';
  wrapper.appendChild(btn);

  roomsContainer.parentNode.insertBefore(wrapper, roomsContainer);
  updateShowAllRatesButton();
  console.log('[ExecLounge] Show All Rates button injected');
}

function updateShowAllRatesButton() {
  const btn = document.getElementById('show-all-rates-btn');
  if (!btn) return;
  if (showAllRatesActive) {
    btn.classList.add('active');
    btn.textContent = '\u2713 Hide All Rates';
  } else {
    btn.classList.remove('active');
    btn.textContent = 'Show All Rates';
  }
}

function toggleShowAllRates() {
  showAllRatesActive = !showAllRatesActive;
  console.log('[ExecLounge] Toggle Show All Rates:', showAllRatesActive);
  sessionStorage.setItem('execShowAllRatesActive', showAllRatesActive.toString());
  updateShowAllRatesButton();
  if (showAllRatesActive) {
    showAllRatesRetryCount = 0;
    injectAllRatePanels();
  } else {
    removeAllRatePanels();
  }
}

// ==================== TOGGLE FEATURE ====================
function applyFilterToCard(card) {
  const hotelId = card.getAttribute('data-hotel-id');
  if (!hotelId) return;
  if (loungeFilterActive && !EXECUTIVE_LOUNGE_HOTEL_IDS.has(hotelId)) {
    card.classList.add('exec-lounge-hidden');
  } else {
    card.classList.remove('exec-lounge-hidden');
  }
}

function applyFilterToAllCards() {
  const cards = document.querySelectorAll('div.result-list-item[data-hotel-id]');
  cards.forEach(applyFilterToCard);
  updateCounter();
}

function updateCounter() {
  const counter = document.getElementById('exec-lounge-counter');
  if (!counter) return;
  const allCards = document.querySelectorAll('div.result-list-item[data-hotel-id]');
  const totalCards = allCards.length;
  let loungeCount = 0;
  allCards.forEach(card => {
    const hotelId = card.getAttribute('data-hotel-id');
    if (EXECUTIVE_LOUNGE_HOTEL_IDS.has(hotelId)) loungeCount++;
  });
  if (loungeFilterActive) {
    counter.textContent = `Showing ${loungeCount} of ${totalCards} hotels with Executive Lounge`;
  } else {
    counter.textContent = `${loungeCount} of ${totalCards} hotels have an Executive Lounge`;
  }
}

function updateToggleButton() {
  const btn = document.getElementById('exec-lounge-toggle-btn');
  if (!btn) return;
  if (loungeFilterActive) {
    btn.classList.add('active');
    btn.textContent = '\u2713 Lounge Only';
  } else {
    btn.classList.remove('active');
    btn.textContent = 'Lounge Only';
  }
}

function toggleFilter() {
  loungeFilterActive = !loungeFilterActive;
  sessionStorage.setItem('execLoungeToggleActive', loungeFilterActive.toString());
  updateToggleButton();
  applyFilterToAllCards();
}

function injectToggleButton() {
  if (document.getElementById('exec-lounge-toggle-btn')) return;

  // Try to find the results header area
  const resultsHeader = document.querySelector('.availability-status-message')
    || document.querySelector('[class*="results-header"]')
    || document.querySelector('[class*="search-results"] h1')
    || document.querySelector('[class*="hotel-count"]')
    || document.querySelector('[class*="result-count"]');

  // Create toggle button
  const btn = document.createElement('button');
  btn.id = 'exec-lounge-toggle-btn';
  btn.type = 'button';
  btn.addEventListener('click', toggleFilter);

  // Create counter
  const counter = document.createElement('span');
  counter.id = 'exec-lounge-counter';

  // Create wrapper
  const wrapper = document.createElement('div');
  wrapper.id = 'exec-lounge-toggle-wrapper';
  wrapper.style.cssText = 'padding: 8px 16px; display: flex; align-items: center; flex-wrap: wrap;';
  wrapper.appendChild(btn);
  wrapper.appendChild(counter);

  if (resultsHeader) {
    resultsHeader.parentNode.insertBefore(wrapper, resultsHeader.nextSibling);
  } else {
    // Fallback: insert before the first result card
    const firstCard = document.querySelector('div.result-list-item[data-hotel-id]');
    if (firstCard && firstCard.parentNode) {
      firstCard.parentNode.insertBefore(wrapper, firstCard);
    } else {
      // Last resort: try again later via observer
      return;
    }
  }

  // Set initial state
  updateToggleButton();
  updateCounter();
}

// ==================== MUTATION OBSERVER ====================
let observer = null;
function startObserver() {
  if (observer) return;
  observer = new MutationObserver((mutations) => {
    // Re-entrancy guard: pause observer while processing to prevent feedback loops
    observer.disconnect();
    for (const mutation of mutations) {
      for (const node of mutation.addedNodes) {
        if (node.nodeType !== Node.ELEMENT_NODE) continue;
        if (node.classList && node.classList.contains('result-list-item') && node.hasAttribute('data-hotel-id')) {
          highlightCard(node);
          addBreakfastBadge(node);
          applyFilterToCard(node);
          addTaxInclusivePrice(node);
          const nodePriceData = parsePriceData(node);
          if (nodePriceData) console.log('[ExecLounge] Price data:', node.getAttribute('data-hotel-id'), nodePriceData);
        }
        if (node.querySelectorAll) {
          node.querySelectorAll('div.result-list-item[data-hotel-id]').forEach(card => {
            highlightCard(card);
            addBreakfastBadge(card);
            applyFilterToCard(card);
            addTaxInclusivePrice(card);
            const cardPriceData = parsePriceData(card);
            if (cardPriceData) console.log('[ExecLounge] Price data:', card.getAttribute('data-hotel-id'), cardPriceData);
          });
        }
      }
    }
    // Update counter when new cards are added
    updateCounter();
    // Try to inject toggle button if it hasn't been placed yet
    if (!document.getElementById('exec-lounge-toggle-btn')) {
      injectToggleButton();
    }
    // Show All Rates: inject button and re-inject panels for new rooms
    if (!document.getElementById('show-all-rates-btn')) {
      injectShowAllRatesButton();
    }
    if (showAllRatesActive) {
      const rooms = document.querySelectorAll('.hotel-accommodation');
      const needsReinject = [...rooms].some(r =>
        !r.querySelector('.ext-all-rates-panel') &&
        !r.classList.contains('hotel-accommodation--selected') &&
        r.offsetHeight > 0
      );
      if (needsReinject) injectAllRatePanels();
    }
    // Detail page: badges, tax-inclusive prices, and loyalty
    injectDetailPageBadges();
    addTaxToDetailPageRooms();
    injectLoyaltyBadge();
    injectBenefitsBox();
    if (isHotelDetailPage() && detectedLoyaltyTier) markUpgradeEligibleRooms();
    // Re-entrancy guard: resume observing after processing
    observer.observe(document.body, { subtree: true, childList: true });
  });
  observer.observe(document.body, { subtree: true, childList: true });
}

function stopObserver() {
  if (observer) {
    observer.disconnect();
    observer = null;
  }
}

// ==================== INIT ====================
function init() {
  // Only run on booking pages
  if (!/\/booking\//i.test(location.pathname)) return;
  console.log('[ExecLounge] init() running - found booking page');
  loungeFilterActive = sessionStorage.getItem('execLoungeToggleActive') === 'true';
  showAllRatesActive = sessionStorage.getItem('execShowAllRatesActive') === 'true';
  injectStyles();
  highlightCards();
  injectToggleButton();
  applyFilterToAllCards();
  injectDetailPageBadges();
  injectShowAllRatesButton();
  if (showAllRatesActive) {
    showAllRatesRetryCount = 0;
    injectAllRatePanels();
  }
  addTaxToDetailPageRooms();
  startObserver();
  // Loyalty detection: restore cached tier or detect async
  detectedLoyaltyTier = sessionStorage.getItem('execLoyaltyTier') || null;
  loyaltyDetectionDone = detectedLoyaltyTier !== null;
  detectAndCacheLoyaltyTier(); // async, non-blocking
}

init();

// v2.2: Watch for route changes on ALL Accor booking pages
(function watchRouteChanges() {
  // Only watch for route changes if we started on a booking page
  if (!/\/booking\//i.test(location.pathname)) return;
  let lastUrl = location.href;
  setInterval(() => {
    if (location.href === lastUrl) return;
    lastUrl = location.href;
    // Clear tax-processed flags so prices recompute on date/currency changes
    document.querySelectorAll('[data-exec-tax-processed]').forEach(el => {
      el.removeAttribute('data-exec-tax-processed');
    });
    // Clean up injected panels on route change
    removeAllRatePanels();
    document.querySelectorAll('.exec-detail-tax').forEach(el => el.remove());
    document.getElementById('exec-loyalty-badge')?.remove();
    document.querySelectorAll('.exec-upgrade-indicator').forEach(el => el.remove());
    const oldBadges = document.getElementById('exec-detail-badges');
    if (oldBadges) oldBadges.remove();
    showAllRatesActive = sessionStorage.getItem('execShowAllRatesActive') === 'true';
    const isTarget = /all\.accor\.com\/booking/i.test(location.href);
    stopObserver();
    if (isTarget) init();
  }, 1000);
})();
